import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt
from mpl_toolkits.axes_grid.inset_locator import inset_axes

mpl.rcParams.update({
    'font.size': 18,
    'lines.linewidth': 3,
    'lines.markersize': 10,
    'lines.markeredgewidth': 3
})

INVALID_RESULT = -1000
MIN_N_IMGS_PER_CHANNEL = 10

# ---------------------------------------------------------------------------------------
# Results
# ---------------------------------------------------------------------------------------
# ./results/pathfinder/
# BinaryClassifierResnet50_CurrentSubtractInhibitLayer_with_puncturing_20200912_190634
model_run_1_ch_in = np.array([
    [    0.174,     0.17 ,     0.171,     0.169,     0.167,     0.167],
    [    0.27 ,     0.269,     0.265,     0.262,     0.262,     0.26 ],
    [    0.341,     0.342,     0.338,     0.338,     0.334,     0.328],
    [    0.258,     0.269,     0.279,     0.269,     0.277,     0.276],
    [    0.785,     0.768,     0.807,     0.817,     0.819,     0.79 ],
    [    2.084,     2.104,     2.081,     2.034,     2.072,     2.053],
    [    3.123,     3.142,     3.205,     3.215,     3.243,     3.245],
    [    1.217,     1.243,     1.47 ,     1.349,     1.392,     1.32 ],
    [   14.133,    13.99 ,    13.694,    13.702,    13.879,    13.656],
    [    1.964,     2.003,     1.995,     2.017,     2.014,     1.946],
    [    4.216,     4.281,     4.3  ,     4.281,     4.296,     4.299],
    [    0.191,     0.191,     0.188,     0.189,     0.188,     0.187],
    [    0.783,     0.785,     0.799,     0.787,     0.794,     0.808],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [   18.955,    18.96 ,    18.963,    18.977,    18.97 ,    18.978],
    [    0.59 ,     0.601,     0.582,     0.572,     0.569,     0.567],
    [    0.306,     0.299,     0.296,     0.304,     0.305,     0.307],
    [    7.107,     7.09 ,     7.022,     6.949,     6.825,     6.794],
    [    0.172,     0.17 ,     0.176,     0.177,     0.181,     0.17 ],
    [    2.394,     2.383,     2.365,     2.354,     2.348,     2.325],
    [    2.609,     2.61 ,     2.61 ,     2.612,     2.621,     2.626],
    [    1.987,     1.944,     1.917,     1.927,     1.961,     1.871],
    [    1.636,     1.622,     1.673,     1.65 ,     1.639,     1.67 ],
    [    4.934,     4.934,     4.932,     4.932,     4.932,     4.931],
    [    0.256,     0.253,     0.254,     0.253,     0.248,     0.243],
    [    0.322,     0.318,     0.319,     0.32 ,     0.318,     0.317],
    [    1.507,     1.459,     1.655,     1.632,     1.623,     1.669],
    [    2.986,     2.955,     2.895,     2.924,     2.902,     2.862],
    [    3.201,     3.192,     3.188,     3.195,     3.186,     3.182],
    [    0.257,     0.256,     0.255,     0.254,     0.254,     0.251],
    [    1.746,     1.724,     1.719,     1.72 ,     1.714,     1.708],
    [    0.179,     0.183,     0.182,     0.178,     0.181,     0.183],
    [    0.509,     0.509,     0.505,     0.505,     0.505,     0.506],
    [    2.384,     2.379,     2.38 ,     2.405,     2.417,     2.355],
    [    0.953,     0.951,     0.946,     0.941,     0.94 ,     0.937],
    [    3.128,     3.126,     3.129,     3.128,     3.125,     3.123],
    [    2.204,     2.225,     2.231,     2.239,     2.277,     2.172],
    [    6.748,     6.709,     6.625,     6.609,     6.555,     6.421],
    [    7.013,     6.98 ,     6.981,     6.979,     6.944,     6.88 ],
    [   12.749,    12.737,    12.434,    12.479,    12.428,    12.073],
    [    0.   ,     0.   ,     0.   ,     0.   ,     0.   ,     0.   ],
    [   13.574,    13.573,    13.574,    13.57 ,    13.572,    13.579],
    [    0.229,     0.23 ,     0.231,     0.231,     0.231,     0.229],
    [    0.406,     0.407,     0.396,     0.4  ,     0.398,     0.388],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    2.184,     2.185,     2.167,     2.163,     2.154,     2.136],
    [    2.103,     2.092,     2.179,     2.259,     2.158,     2.141],
    [    2.106,     2.117,     2.105,     2.114,     2.095,     2.02 ],
    [    0.795,     0.802,     0.8  ,     0.798,     0.8  ,     0.799],
    [    3.534,     3.529,     3.462,     3.578,     3.486,     3.47 ],
    [    5.938,     5.951,     5.849,     5.84 ,     5.761,     5.587],
    [    2.067,     2.058,     2.051,     2.041,     2.029,     2.026],
    [    0.632,     0.633,     0.629,     0.629,     0.626,     0.615],
    [    3.879,     3.841,     3.884,     3.884,     3.823,     3.845],
    [    7.079,     7.082,     6.96 ,     6.957,     6.889,     6.641],
    [    0.639,     0.663,     0.662,     0.652,     0.661,     0.646],
    [    0.042,     0.042,     0.042,     0.042,     0.042,     0.042],
    [    0.314,     0.31 ,     0.307,     0.307,     0.31 ,     0.31 ],
    [    1.415,     1.417,     1.423,     1.427,     1.429,     1.415],
    [    0.191,     0.191,     0.192,     0.191,     0.19 ,     0.178],
    [    0.715,     0.715,     0.749,     0.732,     0.728,     0.706],
    [    0.521,     0.52 ,     0.554,     0.534,     0.532,     0.524],
    [    0.45 ,     0.449,     0.443,     0.443,     0.442,     0.436],
    [    2.881,     2.908,     2.966,     2.875,     2.929,     2.999]])
model_run_1_ch_out = np.array([
    [   51.777,    51.678,    51.453,    51.236,    49.662,    49.116],
    [   50.247,    50.24 ,    49.738,    48.753,    48.119,    47.845],
    [   55.514,    55.434,    54.469,    54.731,    54.181,    52.748],
    [   72.566,    72.319,    71.262,    71.092,    70.43 ,    70.374],
    [   37.363,    37.672,    37.242,    37.494,    37.164,    37.022],
    [   65.046,    65.553,    64.565,    64.262,    63.632,    62.928],
    [    8.406,     8.306,     8.06 ,     7.917,     7.715,     7.581],
    [   10.847,    11.176,    11.163,    11.533,    11.291,    10.095],
    [   11.141,    11.055,    10.835,    10.848,    10.971,    10.769],
    [   41.727,    42.275,    42.621,    41.543,    41.35 ,    40.64 ],
    [   54.444,    54.084,    53.59 ,    52.854,    51.628,    50.884],
    [   45.585,    45.339,    44.9  ,    43.958,    43.236,    43.032],
    [   44.123,    44.066,    43.723,    43.431,    43.456,    43.123],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [   71.849,    72.455,    72.359,    72.304,    72.575,    72.734],
    [   47.384,    46.681,    47.11 ,    46.345,    45.303,    45.539],
    [   50.715,    50.523,    50.094,    49.572,    48.853,    48.301],
    [   13.925,    13.625,    13.109,    12.973,    12.717,    12.37 ],
    [   47.705,    47.873,    46.828,    46.79 ,    46.674,    46.052],
    [    2.262,     2.253,     2.216,     2.257,     2.323,     2.295],
    [    1.539,     1.556,     1.568,     1.563,     1.584,     1.595],
    [   48.894,    48.44 ,    48.268,    47.908,    47.317,    46.355],
    [   81.331,    80.295,    79.546,    77.986,    76.657,    75.382],
    [    3.804,     3.803,     3.802,     3.802,     3.802,     3.801],
    [   54.18 ,    53.829,    53.729,    53.938,    53.928,    53.768],
    [   76.823,    77.582,    77.102,    76.11 ,    73.963,    73.547],
    [   36.768,    36.247,    36.542,    35.997,    35.345,    34.94 ],
    [    2.267,     2.244,     2.197,     2.219,     2.199,     2.168],
    [    2.117,     2.103,     2.081,     2.058,     2.008,     1.993],
    [   91.587,    91.359,    89.329,    89.929,    88.28 ,    87.841],
    [   44.647,    43.783,    43.412,    42.111,    41.028,    40.602],
    [   68.11 ,    68.399,    67.759,    66.907,    66.249,    65.751],
    [    0.   ,     0.   ,     0.   ,     0.   ,     0.   ,     0.   ],
    [   94.252,    92.94 ,    91.651,    91.296,    90.868,    90.837],
    [    0.803,     0.803,     0.799,     0.796,     0.795,     0.793],
    [   50.417,    50.656,    49.838,    49.48 ,    48.741,    48.424],
    [   47.006,    46.746,    46.456,    46.224,    45.785,    45.631],
    [    5.694,     5.641,     5.521,     5.456,     5.38 ,     5.258],
    [    5.011,     5.032,     5.031,     5.065,     4.958,     4.849],
    [    9.938,     9.951,     9.728,     9.788,     9.745,     9.457],
    [   34.796,    35.236,    35.058,    34.863,    34.951,    34.42 ],
    [  223.019,   222.7  ,   222.164,   219.667,   217.82 ,   216.958],
    [   47.854,    47.562,    46.857,    47.448,    46.699,    45.853],
    [   55.649,    55.755,    55.588,    55.448,    55.202,    55.434],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    1.456,     1.479,     1.49 ,     1.48 ,     1.44 ,     1.412],
    [   11.603,    11.961,    12.226,    12.541,    12.579,    12.528],
    [   66.116,    65.776,    65.251,    64.88 ,    63.98 ,    63.296],
    [   10.274,    10.371,    10.165,    10.222,    10.213,    10.178],
    [   35.944,    35.899,    35.827,    35.475,    34.711,    34.961],
    [    4.564,     4.559,     4.473,     4.476,     4.43 ,     4.284],
    [    1.522,     1.536,     1.541,     1.529,     1.513,     1.473],
    [    0.28 ,     0.28 ,     0.277,     0.277,     0.274,     0.266],
    [   37.626,    37.619,    37.19 ,    36.498,    35.646,    35.373],
    [    5.644,     5.71 ,     5.626,     5.628,     5.549,     5.311],
    [   55.662,    55.807,    55.021,    54.605,    53.814,    54.144],
    [   55.444,    55.191,    54.44 ,    54.266,    53.844,    53.242],
    [   82.394,    82.13 ,    82.083,    81.531,    80.809,    79.978],
    [    0.258,     0.311,     0.378,     0.417,     0.454,     0.458],
    [  117.27 ,   117.314,   115.543,   114.007,   112.803,   111.431],
    [   32.108,    32.018,    31.66 ,    31.221,    30.836,    30.405],
    [   41.236,    41.653,    40.899,    41.286,    41.013,    40.458],
    [   73.588,    74.283,    73.355,    72.681,    71.413,    70.775],
    [   71.02 ,    71.263,    70.519,    70.085,    68.677,    67.542]])
model_run_1_ch_predicts = np.array([
    [    0.966,     0.968,     0.964,     0.965,     0.96 ,     0.958],
    [    0.912,     0.908,     0.905,     0.899,     0.894,     0.892],
    [    0.827,     0.831,     0.822,     0.823,     0.817,     0.818],
    [    0.909,     0.9  ,     0.9  ,     0.896,     0.894,     0.894],
    [    0.751,     0.755,     0.755,     0.742,     0.734,     0.735],
    [    0.937,     0.941,     0.946,     0.938,     0.945,     0.942],
    [    0.786,     0.789,     0.789,     0.773,     0.77 ,     0.769],
    [    0.326,     0.318,     0.318,     0.322,     0.319,     0.333],
    [    0.712,     0.697,     0.696,     0.693,     0.691,     0.681],
    [    0.895,     0.891,     0.891,     0.887,     0.885,     0.888],
    [    0.928,     0.915,     0.919,     0.915,     0.91 ,     0.9  ],
    [    0.646,     0.645,     0.647,     0.636,     0.641,     0.637],
    [    0.928,     0.926,     0.926,     0.926,     0.927,     0.921],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    0.957,     0.959,     0.96 ,     0.961,     0.961,     0.96 ],
    [    0.834,     0.824,     0.831,     0.819,     0.81 ,     0.803],
    [    0.68 ,     0.679,     0.671,     0.67 ,     0.666,     0.675],
    [    0.838,     0.832,     0.839,     0.839,     0.836,     0.83 ],
    [    0.789,     0.782,     0.772,     0.763,     0.752,     0.75 ],
    [    0.638,     0.633,     0.632,     0.621,     0.616,     0.605],
    [    0.807,     0.817,     0.81 ,     0.803,     0.8  ,     0.796],
    [    0.584,     0.589,     0.591,     0.585,     0.581,     0.58 ],
    [    0.846,     0.854,     0.856,     0.844,     0.847,     0.839],
    [    0.751,     0.734,     0.728,     0.719,     0.706,     0.7  ],
    [    0.82 ,     0.819,     0.829,     0.83 ,     0.828,     0.83 ],
    [    0.974,     0.977,     0.976,     0.977,     0.98 ,     0.98 ],
    [    0.822,     0.818,     0.815,     0.807,     0.804,     0.8  ],
    [    0.832,     0.826,     0.828,     0.824,     0.81 ,     0.813],
    [    0.721,     0.72 ,     0.718,     0.713,     0.721,     0.714],
    [    0.985,     0.983,     0.982,     0.984,     0.981,     0.98 ],
    [    0.775,     0.779,     0.771,     0.763,     0.767,     0.769],
    [    0.928,     0.925,     0.927,     0.916,     0.912,     0.911],
    [    0.739,     0.784,     0.811,     0.678,     0.685,     0.646],
    [    0.976,     0.975,     0.972,     0.968,     0.967,     0.968],
    [    0.746,     0.75 ,     0.745,     0.741,     0.739,     0.734],
    [    0.94 ,     0.941,     0.941,     0.941,     0.937,     0.938],
    [    0.813,     0.813,     0.803,     0.796,     0.782,     0.768],
    [    0.629,     0.621,     0.613,     0.613,     0.607,     0.625],
    [    0.654,     0.653,     0.654,     0.653,     0.655,     0.662],
    [    0.755,     0.752,     0.747,     0.741,     0.739,     0.739],
    [    0.779,     0.776,     0.776,     0.772,     0.766,     0.761],
    [    0.987,     0.987,     0.987,     0.987,     0.986,     0.985],
    [    0.931,     0.93 ,     0.926,     0.931,     0.929,     0.922],
    [    0.544,     0.544,     0.553,     0.546,     0.546,     0.536],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    0.671,     0.667,     0.661,     0.665,     0.657,     0.66 ],
    [    0.89 ,     0.888,     0.887,     0.879,     0.877,     0.879],
    [    0.951,     0.952,     0.952,     0.951,     0.95 ,     0.946],
    [    0.963,     0.964,     0.956,     0.953,     0.953,     0.943],
    [    0.867,     0.862,     0.855,     0.855,     0.854,     0.851],
    [    0.7  ,     0.7  ,     0.692,     0.704,     0.692,     0.68 ],
    [    0.685,     0.687,     0.685,     0.684,     0.683,     0.679],
    [    0.691,     0.692,     0.696,     0.689,     0.686,     0.685],
    [    0.898,     0.896,     0.891,     0.89 ,     0.881,     0.881],
    [    0.787,     0.776,     0.784,     0.769,     0.77 ,     0.765],
    [    0.886,     0.874,     0.871,     0.873,     0.86 ,     0.859],
    [    0.769,     0.768,     0.761,     0.748,     0.754,     0.756],
    [    0.978,     0.976,     0.972,     0.971,     0.971,     0.967],
    [    0.705,     0.691,     0.692,     0.703,     0.689,     0.683],
    [    0.988,     0.987,     0.986,     0.986,     0.984,     0.985],
    [    0.806,     0.805,     0.789,     0.786,     0.787,     0.777],
    [    0.898,     0.895,     0.883,     0.889,     0.882,     0.879],
    [    0.976,     0.972,     0.972,     0.97 ,     0.959,     0.957],
    [    0.922,     0.91 ,     0.9  ,     0.901,     0.899,     0.895]])
model_run_1_n_images = \
    [50, 50, 49, 50, 50, 50, 50, 14, 50, 49,
     50, 50, 50,  0, 49, 49, 50, 50, 50, 50,
     50, 49, 50, 50, 50, 49, 50, 49, 50, 49,
     49, 50,  2, 50, 50, 50, 50, 50, 49, 50,
     50, 49, 50, 49,  0, 49, 50, 49, 49, 49,
     50, 49, 50, 50, 50, 50, 49, 50, 50, 50,
     50, 49, 50, 50]

# ./results/pathfinder/
# BinaryClassifierResnet50_CurrentSubtractInhibitLayer_with_puncturing_run_2_20200913_173149
model_run_2_ch_in = np.array([
    [    3.368,     3.32 ,     3.259,     3.247,     3.21 ,     3.253],
    [    0.56 ,     0.557,     0.551,     0.549,     0.546,     0.538],
    [    1.112,     1.111,     1.105,     1.105,     1.105,     1.104],
    [    1.359,     1.364,     1.446,     1.442,     1.424,     1.343],
    [    3.767,     3.765,     3.812,     3.795,     3.734,     3.655],
    [    7.879,     7.822,     7.782,     7.737,     7.64 ,     7.594],
    [    2.082,     2.081,     2.091,     2.087,     2.012,     2.15 ],
    [    1.04 ,     1.105,     1.147,     1.179,     1.223,     1.354],
    [   20.352,    20.307,    19.986,    20.119,    20.417,    20.156],
    [   10.905,    10.861,    10.8  ,    10.774,    10.76 ,    10.693],
    [   30.574,    30.58 ,    30.453,    30.416,    30.647,    30.611],
    [    0.58 ,     0.578,     0.576,     0.576,     0.571,     0.57 ],
    [   45.109,    45.109,    45.114,    45.109,    45.11 ,    45.109],
    [    0.   ,     0.   ,     0.   ,     0.   ,     0.   ,     0.   ],
    [   43.854,    43.846,    43.812,    43.821,    43.819,    43.826],
    [    3.62 ,     3.596,     3.546,     3.513,     3.497,     3.474],
    [    1.159,     1.158,     1.169,     1.16 ,     1.153,     1.175],
    [   16.673,    16.589,    16.479,    16.336,    16.295,    16.028],
    [    2.514,     2.516,     2.538,     2.537,     2.599,     2.591],
    [    0.537,     0.535,     0.533,     0.527,     0.523,     0.522],
    [   15.67 ,    15.675,    15.638,    15.627,    15.623,    15.732],
    [    2.977,     3.003,     2.964,     2.983,     2.984,     2.922],
    [    4.741,     4.772,     4.782,     4.767,     4.71 ,     5.02 ],
    [    0.528,     0.525,     0.518,     0.519,     0.517,     0.511],
    [    4.074,     4.039,     4.038,     4.047,     3.925,     3.764],
    [    0.964,     0.973,     0.972,     0.978,     0.974,     0.971],
    [   19.08 ,    19.128,    19.076,    19.033,    18.9  ,    18.898],
    [   17.408,    17.374,    17.145,    17.09 ,    17.053,    16.955],
    [    3.721,     3.719,     3.65 ,     3.709,     3.626,     3.554],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    4.07 ,     4.086,     4.042,     4.028,     3.999,     3.922],
    [    6.49 ,     6.466,     6.421,     6.399,     6.376,     6.288],
    [    0.455,     0.455,     0.45 ,     0.449,     0.448,     0.442],
    [    4.115,     4.14 ,     3.957,     3.973,     3.972,     3.735],
    [    3.867,     3.847,     3.822,     3.813,     3.802,     3.763],
    [    1.31 ,     1.308,     1.306,     1.305,     1.305,     1.304],
    [    8.891,     8.854,     8.814,     8.84 ,     8.806,     8.777],
    [    1.677,     1.671,     1.701,     1.683,     1.629,     1.617],
    [    3.216,     3.179,     3.455,     3.39 ,     3.363,     3.52 ],
    [    2.8  ,     2.779,     2.79 ,     2.783,     2.792,     2.878],
    [    0.591,     0.59 ,     0.589,     0.589,     0.589,     0.591],
    [    5.193,     5.167,     5.2  ,     5.196,     5.193,     5.27 ],
    [    0.692,     0.691,     0.689,     0.688,     0.692,     0.687],
    [    5.302,     5.302,     5.293,     5.301,     5.303,     5.304],
    [    0.4  ,     0.396,     0.39 ,     0.387,     0.386,     0.377],
    [    5.777,     5.774,     5.771,     5.8  ,     5.801,     5.793],
    [    2.216,     2.138,     2.117,     2.166,     2.143,     2.16 ],
    [    2.75 ,     2.709,     2.768,     2.757,     2.754,     2.822],
    [    0.675,     0.674,     0.678,     0.679,     0.678,     0.679],
    [    2.52 ,     2.476,     2.407,     2.416,     2.392,     2.274],
    [    1.444,     1.46 ,     1.475,     1.454,     1.458,     1.457],
    [   15.513,    15.441,    15.396,    15.434,    15.408,    15.353],
    [    0.75 ,     0.751,     0.727,     0.728,     0.701,     0.679],
    [   15.241,    15.128,    14.998,    15.005,    14.863,    14.72 ],
    [   16.144,    16.06 ,    15.728,    15.763,    15.68 ,    15.431],
    [    2.204,     2.174,     2.207,     2.225,     2.214,     2.239],
    [   17.754,    17.754,    17.754,    17.755,    17.754,    17.754],
    [    2.133,     2.137,     2.133,     2.136,     2.13 ,     2.123],
    [    2.185,     2.188,     2.177,     2.179,     2.166,     2.165],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    2.38 ,     2.337,     2.437,     2.37 ,     2.415,     2.473],
    [    2.161,     2.196,     2.245,     2.209,     2.345,     2.359],
    [    2.311,     2.305,     2.299,     2.3  ,     2.285,     2.269],
    [    7.43 ,     7.428,     7.282,     7.285,     6.975,     6.92 ]])
model_run_2_ch_out = np.array([
    [  135.373,   135.474,   134.027,   132.886,   131.392,   129.997],
    [   10.765,    11.079,    11.307,    11.41 ,    11.518,    11.367],
    [  116.397,   116.046,   115.496,   115.238,   113.99 ,   113.204],
    [  179.813,   179.693,   177.84 ,   177.775,   174.413,   170.056],
    [  165.578,   165.445,   164.718,   162.656,   161.354,   160.276],
    [    5.327,     5.305,     5.29 ,     5.272,     5.125,     5.042],
    [   67.588,    67.224,    67.347,    67.825,    67.168,    67.258],
    [   76.209,    74.628,    73.962,    72.925,    72.597,    69.246],
    [   14.687,    14.726,    14.533,    14.67 ,    14.906,    14.735],
    [    8.991,     8.959,     8.892,     8.839,     8.77 ,     8.643],
    [   24.331,    24.336,    24.234,    24.205,    24.389,    24.36 ],
    [  110.804,   111.245,   112.811,   111.689,   109.969,   110.62 ],
    [   35.75 ,    35.909,    36.   ,    36.072,    36.114,    36.076],
    [  142.399,   141.699,   140.947,   141.22 ,   140.871,   140.113],
    [  199.479,   200.514,   198.755,   199.448,   199.1  ,   199.141],
    [   70.913,    71.596,    71.05 ,    70.448,    68.34 ,    65.64 ],
    [   98.523,    99.069,    98.777,    98.211,    97.544,    97.097],
    [   12.807,    12.686,    12.51 ,    12.347,    12.226,    11.871],
    [   93.588,    94.505,    94.854,    94.11 ,    93.105,    92.607],
    [   45.588,    45.489,    44.186,    43.748,    43.085,    41.378],
    [   10.162,    10.356,    10.449,    10.558,    10.643,    10.782],
    [  112.408,   113.829,   111.457,   111.281,   109.369,   108.258],
    [   96.568,    96.87 ,    95.865,    95.393,    93.977,    92.52 ],
    [   85.559,    84.744,    83.318,    84.292,    82.14 ,    81.777],
    [   43.215,    42.469,    41.85 ,    40.736,    39.123,    38.377],
    [  105.628,   105.223,   104.539,   103.182,   101.894,   101.623],
    [   14.908,    14.867,    14.717,    14.689,    14.476,    14.463],
    [   13.509,    13.5  ,    13.335,    13.326,    13.299,    13.233],
    [   91.64 ,    91.576,    91.524,    90.59 ,    90.854,    89.808],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [   63.793,    63.343,    62.022,    60.   ,    58.264,    56.89 ],
    [    4.7  ,     4.738,     4.698,     4.705,     4.698,     4.674],
    [   32.233,    33.29 ,    32.94 ,    33.032,    32.078,    32.051],
    [  111.778,   110.562,   108.187,   106.891,   104.195,   102.464],
    [    3.242,     3.226,     3.204,     3.198,     3.187,     3.154],
    [  119.125,   118.396,   117.148,   117.884,   114.537,   112.223],
    [    7.425,     7.38 ,     7.34 ,     7.313,     7.259,     7.247],
    [   75.827,    75.451,    74.476,    73.317,    72.686,    71.   ],
    [  110.014,   109.91 ,   110.102,   109.087,   107.791,   106.69 ],
    [   67.501,    67.616,    67.94 ,    66.095,    65.449,    64.156],
    [  136.556,   136.87 ,   134.987,   135.436,   136.635,   133.919],
    [  180.02 ,   180.625,   179.347,   178.339,   177.382,   175.105],
    [  101.724,   101.318,   100.036,   101.067,    99.307,    98.23 ],
    [    3.64 ,     3.662,     3.668,     3.684,     3.689,     3.69 ],
    [   10.37 ,    10.755,    11.032,    11.085,    11.   ,    10.867],
    [  120.825,   121.478,   121.613,   121.164,   121.176,   120.923],
    [   97.36 ,    97.06 ,    95.52 ,    95.597,    94.544,    93.487],
    [  169.731,   169.072,   167.947,   166.639,   164.212,   162.736],
    [   99.742,    99.693,    98.305,    98.304,    97.127,    95.851],
    [   91.391,    90.883,    90.617,    89.78 ,    87.482,    86.537],
    [  196.05 ,   196.877,   195.317,   192.758,   190.191,   190.153],
    [   12.074,    12.028,    11.95 ,    11.963,    11.936,    11.867],
    [  153.686,   153.697,   152.576,   152.274,   149.992,   147.871],
    [   11.703,    11.617,    11.513,    11.498,    11.4  ,    11.258],
    [   12.53 ,    12.471,    12.219,    12.258,    12.176,    11.926],
    [  104.59 ,   104.518,   101.779,    99.436,    98.443,    95.536],
    [   14.401,    14.406,    14.41 ,    14.413,    14.415,    14.411],
    [    1.265,     1.244,     1.221,     1.197,     1.175,     1.177],
    [    1.603,     1.607,     1.598,     1.596,     1.581,     1.579],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [  153.087,   152.756,   151.499,   150.189,   149.938,   146.983],
    [   76.301,    76.178,    75.559,    75.397,    75.858,    76.419],
    [    1.619,     1.661,     1.693,     1.7  ,     1.698,     1.692],
    [    1.844,     2.197,     2.184,     1.931,     1.517,     1.251]])
model_run_2_ch_predicts = np.array([
    [    0.879,     0.881,     0.879,     0.872,     0.878,     0.871],
    [    0.519,     0.513,     0.507,     0.504,     0.481,     0.489],
    [    0.677,     0.681,     0.676,     0.675,     0.668,     0.665],
    [    0.925,     0.922,     0.917,     0.922,     0.919,     0.912],
    [    0.996,     0.995,     0.995,     0.994,     0.995,     0.994],
    [    0.737,     0.728,     0.734,     0.733,     0.729,     0.727],
    [    0.753,     0.744,     0.746,     0.741,     0.742,     0.741],
    [    0.564,     0.556,     0.559,     0.54 ,     0.533,     0.523],
    [    0.784,     0.773,     0.773,     0.766,     0.763,     0.755],
    [    0.75 ,     0.744,     0.742,     0.746,     0.733,     0.736],
    [    0.696,     0.701,     0.685,     0.685,     0.68 ,     0.671],
    [    0.57 ,     0.567,     0.54 ,     0.545,     0.531,     0.526],
    [    0.885,     0.879,     0.87 ,     0.867,     0.872,     0.866],
    [    0.958,     0.957,     0.955,     0.954,     0.954,     0.957],
    [    0.731,     0.725,     0.725,     0.722,     0.713,     0.719],
    [    0.702,     0.697,     0.686,     0.69 ,     0.679,     0.677],
    [    0.577,     0.576,     0.562,     0.567,     0.557,     0.528],
    [    0.749,     0.749,     0.732,     0.727,     0.718,     0.713],
    [    0.895,     0.897,     0.899,     0.899,     0.897,     0.89 ],
    [    0.718,     0.718,     0.716,     0.705,     0.702,     0.698],
    [    0.79 ,     0.78 ,     0.778,     0.784,     0.775,     0.772],
    [    0.917,     0.912,     0.912,     0.904,     0.901,     0.902],
    [    0.697,     0.693,     0.686,     0.687,     0.673,     0.666],
    [    0.703,     0.701,     0.7  ,     0.695,     0.688,     0.687],
    [    0.681,     0.683,     0.673,     0.672,     0.678,     0.675],
    [    0.699,     0.694,     0.688,     0.681,     0.682,     0.679],
    [    0.758,     0.761,     0.752,     0.735,     0.722,     0.737],
    [    0.857,     0.849,     0.856,     0.856,     0.847,     0.842],
    [    0.748,     0.741,     0.733,     0.733,     0.722,     0.728],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    0.717,     0.702,     0.707,     0.697,     0.685,     0.671],
    [    0.744,     0.731,     0.723,     0.717,     0.719,     0.712],
    [    0.608,     0.594,     0.6  ,     0.59 ,     0.575,     0.584],
    [    0.884,     0.88 ,     0.884,     0.877,     0.88 ,     0.87 ],
    [    0.824,     0.816,     0.791,     0.791,     0.784,     0.779],
    [    0.932,     0.935,     0.932,     0.931,     0.928,     0.917],
    [    0.776,     0.766,     0.76 ,     0.768,     0.759,     0.75 ],
    [    0.785,     0.773,     0.774,     0.769,     0.775,     0.776],
    [    0.82 ,     0.814,     0.813,     0.822,     0.821,     0.833],
    [    0.738,     0.723,     0.716,     0.716,     0.708,     0.706],
    [    0.971,     0.974,     0.974,     0.971,     0.972,     0.966],
    [    0.816,     0.806,     0.818,     0.819,     0.813,     0.816],
    [    0.488,     0.492,     0.476,     0.475,     0.476,     0.47 ],
    [    0.752,     0.753,     0.757,     0.744,     0.738,     0.734],
    [    0.498,     0.494,     0.5  ,     0.488,     0.481,     0.494],
    [    0.894,     0.897,     0.897,     0.891,     0.892,     0.894],
    [    0.907,     0.905,     0.906,     0.902,     0.896,     0.898],
    [    0.87 ,     0.868,     0.869,     0.866,     0.859,     0.851],
    [    0.673,     0.681,     0.679,     0.674,     0.67 ,     0.67 ],
    [    0.594,     0.576,     0.581,     0.576,     0.582,     0.572],
    [    0.937,     0.932,     0.927,     0.926,     0.926,     0.928],
    [    0.755,     0.759,     0.76 ,     0.758,     0.753,     0.757],
    [    0.983,     0.985,     0.985,     0.986,     0.982,     0.981],
    [    0.867,     0.869,     0.872,     0.876,     0.874,     0.864],
    [    0.746,     0.744,     0.738,     0.735,     0.736,     0.726],
    [    0.74 ,     0.748,     0.75 ,     0.751,     0.753,     0.748],
    [    0.902,     0.903,     0.9  ,     0.892,     0.894,     0.887],
    [    0.939,     0.939,     0.93 ,     0.93 ,     0.929,     0.93 ],
    [    0.825,     0.819,     0.83 ,     0.825,     0.816,     0.811],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    0.857,     0.858,     0.861,     0.87 ,     0.873,     0.877],
    [    0.858,     0.85 ,     0.847,     0.838,     0.835,     0.847],
    [    0.85 ,     0.845,     0.845,     0.836,     0.831,     0.824],
    [    0.984,     0.981,     0.98 ,     0.98 ,     0.98 ,     0.973]])
model_run_2_n_images = [
    49, 50, 49, 49, 50, 50, 49, 49, 50, 49,
    21, 50, 50, 50, 49, 50, 50, 50, 49, 50,
    50, 49, 50, 50, 50, 50, 50, 49, 50,  0,
    49, 50, 41, 50, 49, 50, 49, 50, 49, 49,
    50, 50, 50, 50, 50, 49, 49, 50, 50, 50,
    50, 50, 50, 50, 49, 49, 49, 50, 50,  0,
    50, 50, 50, 1]

# ./results/pathfinder/
# BinaryClassifierResnet50_CurrentSubtractInhibitLayer_with_puncturing_run_3_20200914_230957
model_run_3_ch_in = np.array([
    [   11.429,    11.412,    11.165,    11.163,    11.175,    11.011],
   [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
   [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
   [    1.985,     2.012,     1.984,     1.981,     1.977,     1.917],
   [    4.568,     4.586,     4.44 ,     4.416,     4.41 ,     4.312],
   [    1.059,     1.081,     1.13 ,     1.115,     1.108,     1.099],
   [   14.252,    14.245,    14.243,    14.245,    14.23 ,    14.233],
   [    1.296,     1.33 ,     1.813,     1.741,     1.776,     1.613],
   [    3.803,     3.828,     3.881,     3.841,     3.9  ,     3.968],
   [    1.524,     1.537,     1.541,     1.541,     1.544,     1.537],
   [    3.043,     3.062,     3.021,     2.981,     2.968,     2.928],
   [    2.003,     1.991,     1.977,     1.963,     1.979,     2.025],
   [   47.747,    47.748,    47.743,    47.743,    47.742,    47.737],
   [    0.   ,     0.   ,     0.   ,     0.   ,     0.   ,     0.   ],
   [   27.785,    27.799,    27.804,    27.801,    27.769,    27.772],
   [   21.905,    21.913,    21.813,    21.801,    21.914,    21.883],
   [    1.157,     1.149,     1.124,     1.129,     1.123,     1.099],
   [   13.887,    13.875,    13.731,    13.718,    13.486,    13.139],
   [    8.829,     8.813,     8.487,     8.694,     8.831,     8.885],
   [    0.308,     0.314,     0.316,     0.313,     0.313,     0.31 ],
   [    4.67 ,     4.481,     4.561,     4.636,     4.408,     4.454],
   [   18.579,    18.614,    18.528,    18.234,    18.46 ,    18.476],
   [    1.449,     1.553,     1.781,     1.635,     1.792,     1.934],
   [    0.375,     0.371,     0.371,     0.372,     0.37 ,     0.369],
   [    3.386,     3.395,     3.417,     3.391,     3.384,     3.263],
   [    0.644,     0.637,     0.623,     0.624,     0.615,     0.603],
   [    3.643,     3.612,     3.803,     3.761,     3.824,     3.795],
   [   14.195,    14.111,    14.078,    14.117,    14.004,    13.868],
   [    2.572,     2.554,     2.55 ,     2.57 ,     2.565,     2.574],
   [    0.882,     0.881,     0.879,     0.875,     0.871,     0.865],
   [    1.09 ,     1.137,     1.187,     1.149,     1.16 ,     1.156],
   [    8.406,     8.33 ,     8.257,     8.236,     8.223,     8.014],
   [    0.557,     0.557,     0.557,     0.558,     0.558,     0.555],
   [   23.739,    23.674,    23.639,    23.66 ,    23.742,    23.749],
   [    1.876,     1.857,     1.846,     1.845,     1.831,     1.829],
   [   11.828,    11.824,    11.799,    11.796,    11.784,    11.755],
   [    1.594,     1.576,     1.575,     1.563,     1.547,     1.539],
   [    3.381,     3.362,     3.361,     3.357,     3.349,     3.315],
   [   15.412,    15.422,    15.362,    15.342,    15.231,    15.433],
   [   15.968,    16.02 ,    15.828,    15.852,    15.945,    15.622],
   [    1.465,     1.467,     1.467,     1.469,     1.469,     1.464],
   [   11.985,    11.949,    11.979,    11.962,    11.954,    12.027],
   [    2.7  ,     2.7  ,     2.691,     2.696,     2.691,     2.69 ],
   [    0.797,     0.798,     0.793,     0.795,     0.794,     0.78 ],
   [    1.986,     1.984,     1.981,     1.976,     1.979,     1.97 ],
   [   10.407,    10.397,    10.346,    10.326,    10.261,    10.143],
   [    2.638,     2.67 ,     2.539,     2.594,     2.711,     2.613],
   [    2.107,     2.121,     2.144,     2.16 ,     2.149,     2.16 ],
   [    1.937,     1.932,     1.928,     1.924,     1.884,     1.947],
   [   18.236,    18.313,    18.004,    17.856,    17.642,    17.084],
   [    1.665,     1.669,     1.672,     1.66 ,     1.635,     1.618],
   [    1.283,     1.265,     1.359,     1.354,     1.318,     1.353],
   [    1.187,     1.183,     1.179,     1.179,     1.173,     1.144],
   [    1.767,     1.76 ,     1.752,     1.786,     1.696,     1.759],
   [    4.164,     4.153,     4.137,     4.152,     4.096,     4.175],
   [    2.396,     2.389,     2.345,     2.329,     2.311,     2.269],
   [    1.889,     1.886,     1.881,     1.88 ,     1.878,     1.878],
   [    0.975,     0.973,     0.973,     0.977,     0.991,     0.963],
   [    1.986,     1.978,     1.967,     1.966,     1.98 ,     1.978],
   [    0.839,     0.841,     0.839,     0.832,     0.812,     0.79 ],
   [    2.937,     2.833,     2.868,     2.9  ,     2.849,     2.844],
   [    1.143,     1.207,     1.323,     1.275,     1.322,     1.344],
   [    2.882,     2.874,     2.862,     2.834,     2.835,     2.837],
   [    2.234,     2.27 ,     2.22 ,     2.221,     2.215,     2.234]])
model_run_3_ch_out = np.array([
    [    7.885,     7.973,     7.854,     7.911,     7.949,     7.854],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [   91.607,    93.742,    91.784,    91.566,    91.028,    88.39 ],
    [  205.722,   207.004,   204.046,   204.762,   202.441,   200.896],
    [  148.835,   147.527,   147.618,   147.802,   146.74 ,   142.995],
    [   12.585,    12.709,    12.854,    12.887,    12.867,    12.789],
    [  150.183,   147.631,   145.416,   144.347,   142.385,   140.893],
    [  305.26 ,   304.641,   299.944,   298.569,   291.218,   285.057],
    [  171.481,   174.799,   173.772,   174.625,   173.199,   174.92 ],
    [  252.45 ,   253.483,   253.027,   253.586,   252.321,   249.964],
    [    1.298,     1.304,     1.297,     1.277,     1.277,     1.329],
    [   40.171,    40.171,    40.167,    40.167,    40.166,    40.162],
    [  147.885,   148.053,   147.635,   146.854,   146.856,   146.419],
    [  585.243,   583.645,   580.172,   575.903,   570.759,   561.18 ],
    [   15.71 ,    15.748,    15.689,    15.689,    15.771,    15.735],
    [  162.043,   160.708,   158.681,   156.223,   151.356,   149.064],
    [   10.879,    10.916,    10.844,    10.855,    10.688,    10.417],
    [   20.879,    21.003,    20.999,    21.045,    21.287,    21.091],
    [  190.805,   191.65 ,   189.416,   188.429,   186.712,   185.041],
    [   10.481,    10.678,    10.648,    11.341,    11.121,    11.673],
    [   14.543,    14.674,    14.621,    14.433,    14.675,    14.717],
    [  131.778,   130.827,   130.287,   129.269,   126.02 ,   122.562],
    [  121.853,   121.388,   120.11 ,   122.219,   119.017,   116.351],
    [  146.17 ,   149.025,   151.696,   153.115,   149.9  ,   154.311],
    [  140.088,   140.034,   138.372,   137.454,   135.767,   132.709],
    [  258.551,   258.359,   256.25 ,   255.191,   254.044,   253.041],
    [    9.836,     9.778,     9.567,     9.635,     9.361,     9.159],
    [  103.43 ,   102.112,   100.896,   100.253,   100.375,   100.498],
    [  107.255,   107.591,   105.255,   103.194,   103.752,   104.08 ],
    [   62.033,    64.518,    63.835,    64.935,    64.861,    64.128],
    [    6.505,     6.446,     6.388,     6.372,     6.361,     6.197],
    [  111.343,   110.975,   110.721,   111.195,   108.046,   107.275],
    [   38.941,    39.647,    39.79 ,    39.901,    40.395,    40.727],
    [    5.334,     5.29 ,     5.282,     5.056,     4.942,     4.849],
    [    7.194,     7.206,     7.02 ,     6.94 ,     6.829,     6.67 ],
    [  176.687,   178.937,   177.538,   176.174,   175.767,   173.123],
    [   23.755,    24.299,    23.938,    24.334,    23.329,    23.585],
    [   10.412,    10.592,    10.699,    10.704,    10.643,    10.776],
    [   12.599,    12.657,    12.53 ,    12.554,    12.641,    12.435],
    [    0.763,     0.836,     0.845,     0.861,     0.864,     0.854],
    [  251.771,   253.452,   253.837,   252.239,   254.267,   252.872],
    [    1.937,     1.937,     1.929,     1.933,     1.929,     1.928],
    [   37.277,    37.59 ,    37.718,    36.661,    35.876,    35.985],
    [    1.196,     1.195,     1.192,     1.189,     1.191,     1.184],
    [    5.463,     5.59 ,     5.643,     5.695,     5.695,     5.659],
    [  204.899,   207.539,   207.025,   204.363,   202.129,   201.18 ],
    [   26.931,    26.573,    26.287,    27.034,    25.981,    26.024],
    [    1.248,     1.242,     1.238,     1.234,     1.204,     1.252],
    [   14.219,    14.333,    14.038,    13.935,    13.721,    13.286],
    [  154.517,   154.112,   153.4  ,   151.262,   151.035,   150.171],
    [   71.76 ,    71.266,    71.406,    69.811,    69.799,    69.516],
    [  171.376,   172.174,   171.966,   172.451,   171.626,   170.368],
    [  358.187,   357.431,   355.033,   352.755,   349.782,   346.568],
    [   66.2  ,    66.553,    65.347,    65.112,    64.226,    63.809],
    [  215.335,   213.156,   212.816,   210.866,   207.477,   206.373],
    [   32.417,    32.617,    32.408,    32.706,    32.269,    31.907],
    [  176.526,   175.892,   173.285,   169.999,   169.505,   168.57 ],
    [    1.455,     1.458,     1.442,     1.435,     1.431,     1.413],
    [  199.313,   200.387,   194.344,   191.56 ,   188.021,   186.701],
    [  168.578,   167.667,   167.885,   165.167,   163.938,   161.887],
    [  131.791,   132.322,   131.757,   132.758,   133.486,   132.442],
    [    2.335,     2.352,     2.363,     2.352,     2.358,     2.36 ],
    [  242.792,   243.402,   241.475,   242.155,   241.224,   240.79 ]])
model_run_3_ch_predicts = np.array([
    [    0.735,     0.726,     0.721,     0.732,     0.727,     0.729],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    0.807,     0.824,     0.822,     0.817,     0.818,     0.813],
    [    0.982,     0.985,     0.986,     0.984,     0.984,     0.985],
    [    0.899,     0.899,     0.902,     0.896,     0.9  ,     0.894],
    [    0.849,     0.849,     0.851,     0.853,     0.845,     0.845],
    [    0.889,     0.891,     0.89 ,     0.896,     0.894,     0.892],
    [    0.992,     0.99 ,     0.987,     0.987,     0.983,     0.983],
    [    0.616,     0.61 ,     0.609,     0.604,     0.596,     0.595],
    [    0.96 ,     0.958,     0.956,     0.955,     0.954,     0.951],
    [    0.801,     0.793,     0.789,     0.772,     0.765,     0.759],
    [    0.829,     0.821,     0.807,     0.808,     0.814,     0.806],
    [    0.595,     0.594,     0.593,     0.59 ,     0.584,     0.593],
    [    0.975,     0.975,     0.975,     0.975,     0.975,     0.97 ],
    [    0.776,     0.762,     0.778,     0.786,     0.774,     0.767],
    [    0.796,     0.78 ,     0.776,     0.778,     0.771,     0.767],
    [    0.811,     0.81 ,     0.811,     0.814,     0.814,     0.809],
    [    0.663,     0.662,     0.665,     0.656,     0.663,     0.658],
    [    0.727,     0.732,     0.725,     0.719,     0.718,     0.71 ],
    [    0.64 ,     0.635,     0.632,     0.627,     0.628,     0.621],
    [    0.759,     0.745,     0.738,     0.727,     0.719,     0.718],
    [    0.655,     0.66 ,     0.64 ,     0.659,     0.651,     0.639],
    [    0.756,     0.753,     0.75 ,     0.753,     0.751,     0.744],
    [    0.59 ,     0.592,     0.572,     0.564,     0.577,     0.55 ],
    [    0.504,     0.501,     0.494,     0.496,     0.507,     0.509],
    [    0.995,     0.996,     0.996,     0.996,     0.995,     0.995],
    [    0.7  ,     0.698,     0.7  ,     0.702,     0.699,     0.707],
    [    0.71 ,     0.705,     0.688,     0.685,     0.694,     0.687],
    [    0.581,     0.587,     0.583,     0.588,     0.583,     0.574],
    [    0.866,     0.858,     0.849,     0.845,     0.84 ,     0.842],
    [    0.579,     0.58 ,     0.578,     0.565,     0.562,     0.564],
    [    0.638,     0.634,     0.633,     0.635,     0.64 ,     0.649],
    [    0.781,     0.782,     0.78 ,     0.77 ,     0.757,     0.763],
    [    0.576,     0.583,     0.582,     0.576,     0.572,     0.565],
    [    0.772,     0.774,     0.767,     0.757,     0.756,     0.752],
    [    0.795,     0.792,     0.791,     0.795,     0.798,     0.786],
    [    0.59 ,     0.59 ,     0.599,     0.594,     0.596,     0.581],
    [    0.712,     0.707,     0.704,     0.703,     0.694,     0.692],
    [    0.851,     0.854,     0.85 ,     0.845,     0.84 ,     0.825],
    [    0.798,     0.791,     0.788,     0.782,     0.767,     0.763],
    [    0.936,     0.94 ,     0.925,     0.926,     0.923,     0.925],
    [    0.76 ,     0.753,     0.745,     0.747,     0.747,     0.743],
    [    0.673,     0.67 ,     0.662,     0.669,     0.668,     0.653],
    [    0.771,     0.775,     0.761,     0.766,     0.767,     0.756],
    [    0.672,     0.668,     0.659,     0.65 ,     0.647,     0.643],
    [    0.872,     0.871,     0.866,     0.863,     0.86 ,     0.86 ],
    [    0.666,     0.672,     0.657,     0.662,     0.664,     0.656],
    [    0.79 ,     0.79 ,     0.784,     0.781,     0.778,     0.78 ],
    [    0.811,     0.813,     0.807,     0.806,     0.804,     0.802],
    [    0.78 ,     0.783,     0.776,     0.775,     0.767,     0.775],
    [    0.67 ,     0.668,     0.649,     0.652,     0.654,     0.647],
    [    0.836,     0.831,     0.834,     0.834,     0.832,     0.832],
    [    0.991,     0.991,     0.989,     0.985,     0.984,     0.982],
    [    0.827,     0.829,     0.823,     0.818,     0.811,     0.819],
    [    0.894,     0.894,     0.895,     0.886,     0.883,     0.878],
    [    0.824,     0.82 ,     0.825,     0.822,     0.812,     0.818],
    [    0.943,     0.945,     0.941,     0.944,     0.945,     0.944],
    [    0.758,     0.761,     0.759,     0.755,     0.74 ,     0.731],
    [    0.871,     0.869,     0.87 ,     0.865,     0.86 ,     0.854],
    [    0.851,     0.853,     0.845,     0.843,     0.839,     0.838],
    [    0.643,     0.626,     0.625,     0.632,     0.633,     0.626],
    [    0.699,     0.699,     0.685,     0.674,     0.685,     0.683],
    [    0.916,     0.917,     0.911,     0.914,     0.911,     0.914]])
model_run_3_n_images = [
    50,  0,  0, 50, 50, 50, 49, 50, 49, 50,
    49, 49, 50, 50, 49, 49, 50, 50, 50, 50,
    25, 50, 50, 50, 50, 50, 50, 50, 50, 49,
    49, 50, 49, 49, 50, 50, 50, 50, 49, 50,
    49, 49, 50, 49, 50, 50, 49, 50, 50, 49,
    50, 49, 50, 49, 50, 50, 50, 50, 50, 50,
    50, 50, 50, 50]


# ---------------------------------------------------------------------------------------
# ./results/pathfinder/
# BinaryClassifierResnet50_ControlMatchParametersLayer_with_puncturing_20200912_115017
control_run_1_ch_in = np.array([
    [2.925, 2.893, 2.853, 2.801, 2.822, 2.83 ],
    [0.401, 0.401, 0.397, 0.397, 0.395, 0.393],
    [0.138, 0.137, 0.135, 0.135, 0.135, 0.127],
    [1.592, 1.588, 1.567, 1.587, 1.557, 1.578],
    [4.752, 4.763, 4.717, 4.722, 4.738, 4.627],
    [1.242, 1.219, 1.268, 1.251, 1.241, 1.263],
    [3.226, 3.216, 3.177, 3.186, 3.203, 3.259],
    [3.707, 3.706, 3.685, 3.669, 3.67 , 3.656],
    [2.459, 2.443, 2.48 , 2.48 , 2.549, 2.53 ],
    [2.134, 2.117, 2.121, 2.107, 2.092, 2.011],
    [2.138, 2.118, 2.166, 2.162, 2.197, 2.224],
    [0.662, 0.661, 0.655, 0.657, 0.659, 0.653],
    [4.505, 4.493, 4.532, 4.515, 4.504, 4.495],
    [0.   , 0.   , 0.   , 0.   , 0.   , 0.   ],
    [0.691, 0.682, 0.682, 0.669, 0.662, 0.66 ],
    [1.824, 1.797, 1.823, 1.835, 1.755, 1.788],
    [0.932, 0.927, 0.922, 0.915, 0.901, 0.868],
    [1.533, 1.587, 1.602, 1.571, 1.537, 1.508],
    [1.511, 1.502, 1.834, 1.828, 1.822, 1.738],
    [1.117, 1.116, 1.113, 1.111, 1.111, 1.105],
    [2.016, 1.962, 1.813, 1.868, 1.881, 1.988],
    [3.113, 3.134, 3.238, 3.153, 3.13 , 3.02 ],
    [3.577, 3.612, 3.591, 3.572, 3.546, 3.625],
    [0.671, 0.667, 0.658, 0.657, 0.652, 0.644],
    [3.475, 3.497, 3.5  , 3.45 , 3.407, 3.288],
    [0.268, 0.266, 0.286, 0.282, 0.279, 0.288],
    [3.174, 3.205, 3.229, 3.246, 3.29 , 3.203],
    [2.432, 2.527, 2.576, 2.513, 2.511, 2.506],
    [2.455, 2.476, 2.445, 2.427, 2.395, 2.412],
    [0.467, 0.467, 0.461, 0.46 , 0.459, 0.445],
    [1.664, 1.661, 1.691, 1.633, 1.635, 1.653],
    [1.058, 1.047, 1.069, 1.008, 0.999, 0.984],
    [0.12 , 0.12 , 0.119, 0.119, 0.119, 0.114],
    [2.337, 2.32 , 2.191, 2.256, 2.213, 2.09 ],
    [1.073, 1.069, 1.063, 1.063, 1.064, 1.048],
    [6.863, 6.867, 6.869, 6.882, 6.867, 6.857],
    [1.958, 1.959, 2.108, 2.058, 2.107, 2.198],
    [1.135, 1.115, 1.104, 1.051, 1.038, 0.995],
    [3.424, 3.462, 3.441, 3.542, 3.481, 3.543],
    [3.445, 3.421, 3.306, 3.333, 3.306, 3.174],
    [0.111, 0.11 , 0.109, 0.106, 0.109, 0.107],
    [5.113, 5.103, 5.103, 5.078, 5.102, 5.1  ],
    [0.276, 0.275, 0.279, 0.279, 0.278, 0.277],
    [0.271, 0.27 , 0.266, 0.263, 0.263, 0.261],
    [0.063, 0.063, 0.061, 0.061, 0.061, 0.06 ],
    [1.059, 1.033, 1.022, 1.008, 1.005, 1.042],
    [3.97 , 3.944, 4.04 , 4.03 , 4.015, 3.958],
    [2.52 , 2.515, 2.441, 2.428, 2.4  , 2.306],
    [0.082, 0.082, 0.084, 0.084, 0.085, 0.087],
    [5.343, 5.318, 5.329, 5.105, 4.933, 4.751],
    [1.23 , 1.196, 1.21 , 1.248, 1.27 , 1.279],
    [1.081, 1.049, 1.071, 1.056, 1.051, 1.12 ],
    [0.081, 0.081, 0.078, 0.078, 0.077, 0.077],
    [2.419, 2.365, 2.37 , 2.341, 2.332, 2.345],
    [2.958, 2.991, 2.889, 2.874, 2.832, 2.831],
    [2.113, 2.098, 2.075, 2.073, 2.096, 2.072],
    [1.538, 1.536, 1.531, 1.53 , 1.528, 1.527],
    [0.368, 0.372, 0.366, 0.36 , 0.362, 0.36 ],
    [0.072, 0.072, 0.075, 0.074, 0.075, 0.067],
    [0.257, 0.258, 0.258, 0.255, 0.256, 0.252],
    [1.738, 1.717, 1.818, 1.717, 1.828, 1.853],
    [3.335, 3.345, 3.359, 3.276, 3.307, 3.283],
    [0.215, 0.215, 0.216, 0.218, 0.219, 0.219],
    [1.169, 1.095, 1.216, 1.209, 1.124, 1.156]])
control_run_1_ch_out = np.array([
    [ 3.591,  3.574,  3.548,  3.507,  3.497,  3.45 ],
    [13.156, 13.191, 13.223, 13.265, 13.278, 13.358],
    [ 3.7  ,  3.642,  3.578,  3.527,  3.458,  3.397],
    [ 4.464,  4.416,  4.353,  4.31 ,  4.264,  4.184],
    [ 0.88 ,  0.876,  0.865,  0.851,  0.836,  0.822],
    [ 7.409,  7.449,  7.462,  7.447,  7.452,  7.487],
    [ 4.588,  4.576,  4.548,  4.496,  4.412,  4.315],
    [ 5.682,  5.59 ,  5.57 ,  5.561,  5.494,  5.502],
    [ 0.298,  0.292,  0.289,  0.284,  0.277,  0.265],
    [ 3.479,  3.438,  3.395,  3.366,  3.307,  3.243],
    [ 2.043,  2.007,  1.988,  1.965,  1.929,  1.887],
    [ 0.121,  0.109,  0.111,  0.109,  0.103,  0.094],
    [10.065, 10.06 , 10.037, 10.021, 10.035, 10.032],
    [ 9.64 ,  9.593,  9.503,  9.416,  9.315,  9.178],
    [ 1.657,  1.635,  1.634,  1.63 ,  1.639,  1.62 ],
    [ 0.875,  0.876,  0.88 ,  0.891,  0.891,  0.887],
    [ 0.433,  0.414,  0.401,  0.392,  0.385,  0.368],
    [ 1.042,  1.055,  1.063,  1.071,  1.076,  1.073],
    [ 0.277,  0.281,  0.27 ,  0.272,  0.273,  0.265],
    [ 0.911,  0.906,  0.907,  0.898,  0.891,  0.887],
    [ 0.315,  0.304,  0.308,  0.304,  0.303,  0.299],
    [ 0.537,  0.529,  0.516,  0.509,  0.489,  0.469],
    [ 5.478,  5.497,  5.488,  5.433,  5.403,  5.346],
    [ 1.936,  1.95 ,  1.939,  1.935,  1.93 ,  1.926],
    [ 4.184,  4.156,  4.119,  4.14 ,  4.14 ,  4.075],
    [10.681, 10.645, 10.57 , 10.506, 10.369, 10.261],
    [ 2.861,  2.884,  2.933,  2.953,  2.961,  2.963],
    [ 9.045,  8.933,  8.773,  8.67 ,  8.574,  8.474],
    [ 4.573,  4.556,  4.52 ,  4.483,  4.494,  4.464],
    [ 7.727,  7.738,  7.7  ,  7.702,  7.693,  7.667],
    [ 2.963,  2.869,  2.835,  2.787,  2.742,  2.626],
    [14.73 , 14.762, 14.807, 14.852, 14.907, 14.959],
    [ 0.064,  0.06 ,  0.052,  0.051,  0.046,  0.044],
    [ 0.096,  0.094,  0.09 ,  0.092,  0.084,  0.081],
    [ 5.953,  5.902,  5.811,  5.696,  5.575,  5.581],
    [ 7.337,  7.311,  7.229,  7.205,  7.13 ,  7.065],
    [ 8.171,  8.151,  8.095,  8.077,  7.998,  7.936],
    [ 0.22 ,  0.223,  0.225,  0.224,  0.224,  0.216],
    [ 0.13 ,  0.124,  0.119,  0.115,  0.113,  0.108],
    [ 4.18 ,  4.206,  4.249,  4.259,  4.272,  4.299],
    [ 4.746,  4.766,  4.78 ,  4.789,  4.786,  4.791],
    [11.604, 11.591, 11.573, 11.535, 11.48 , 11.414],
    [12.538, 12.528, 12.534, 12.562, 12.614, 12.721],
    [ 9.381,  9.25 ,  9.143,  9.061,  8.922,  8.798],
    [ 9.872,  9.806,  9.736,  9.661,  9.505,  9.412],
    [ 2.029,  2.021,  2.017,  2.027,  2.034,  2.043],
    [ 7.808,  7.744,  7.715,  7.652,  7.615,  7.555],
    [ 8.657,  8.634,  8.532,  8.413,  8.33 ,  8.27 ],
    [ 0.065,  0.062,  0.058,  0.056,  0.052,  0.048],
    [ 0.189,  0.181,  0.173,  0.165,  0.154,  0.155],
    [ 1.134,  1.137,  1.139,  1.144,  1.148,  1.147],
    [ 0.588,  0.582,  0.574,  0.564,  0.556,  0.549],
    [ 3.316,  3.333,  3.332,  3.356,  3.362,  3.356],
    [ 0.193,  0.192,  0.188,  0.184,  0.181,  0.176],
    [ 9.16 ,  9.177,  9.175,  9.208,  9.248,  9.265],
    [ 4.818,  4.788,  4.774,  4.741,  4.752,  4.725],
    [ 4.021,  3.988,  3.984,  3.965,  3.956,  3.969],
    [11.153, 11.16 , 11.171, 11.129, 11.151, 11.163],
    [10.618, 10.619, 10.505, 10.363, 10.332, 10.175],
    [ 4.098,  4.082,  4.085,  4.084,  4.08 ,  4.033],
    [ 6.041,  5.987,  5.926,  5.776,  5.683,  5.619],
    [ 8.09 ,  8.092,  8.07 ,  8.06 ,  8.065,  8.011],
    [15.272, 15.204, 15.053, 14.921, 14.84 , 14.761],
    [ 0.168,  0.169,  0.166,  0.16 ,  0.15 ,  0.147]])
control_run_1_ch_predicts = np.array([
    [0.695, 0.689, 0.697, 0.691, 0.686, 0.688],
    [0.434, 0.432, 0.426, 0.426, 0.424, 0.415],
    [0.607, 0.605, 0.591, 0.592, 0.587, 0.586],
    [0.618, 0.606, 0.599, 0.589, 0.582, 0.58 ],
    [0.575, 0.564, 0.562, 0.56 , 0.558, 0.546],
    [0.519, 0.519, 0.511, 0.506, 0.502, 0.497],
    [0.741, 0.735, 0.729, 0.733, 0.735, 0.724],
    [0.518, 0.52 , 0.51 , 0.5  , 0.497, 0.487],
    [0.435, 0.434, 0.435, 0.42 , 0.421, 0.408],
    [0.459, 0.46 , 0.452, 0.45 , 0.443, 0.435],
    [0.652, 0.662, 0.655, 0.654, 0.658, 0.653],
    [0.615, 0.606, 0.606, 0.598, 0.591, 0.594],
    [0.497, 0.495, 0.484, 0.483, 0.478, 0.477],
    [0.916, 0.914, 0.911, 0.909, 0.906, 0.903],
    [0.594, 0.594, 0.585, 0.584, 0.583, 0.584],
    [0.595, 0.589, 0.58 , 0.567, 0.554, 0.542],
    [0.582, 0.582, 0.571, 0.57 , 0.574, 0.567],
    [0.599, 0.584, 0.588, 0.581, 0.574, 0.569],
    [0.45 , 0.455, 0.456, 0.452, 0.451, 0.409],
    [0.482, 0.47 , 0.468, 0.476, 0.471, 0.461],
    [0.49 , 0.483, 0.481, 0.475, 0.47 , 0.469],
    [0.527, 0.522, 0.514, 0.518, 0.515, 0.509],
    [0.717, 0.712, 0.707, 0.7  , 0.694, 0.689],
    [0.498, 0.495, 0.492, 0.485, 0.482, 0.48 ],
    [0.843, 0.84 , 0.834, 0.836, 0.834, 0.829],
    [0.989, 0.987, 0.986, 0.984, 0.983, 0.98 ],
    [0.586, 0.589, 0.584, 0.579, 0.578, 0.577],
    [0.982, 0.983, 0.982, 0.981, 0.981, 0.977],
    [0.693, 0.683, 0.688, 0.681, 0.682, 0.69 ],
    [0.875, 0.869, 0.861, 0.852, 0.841, 0.831],
    [0.501, 0.495, 0.487, 0.476, 0.471, 0.465],
    [0.465, 0.46 , 0.457, 0.45 , 0.446, 0.435],
    [0.531, 0.534, 0.531, 0.521, 0.523, 0.523],
    [0.571, 0.554, 0.56 , 0.559, 0.551, 0.554],
    [0.659, 0.667, 0.67 , 0.665, 0.667, 0.657],
    [0.961, 0.959, 0.957, 0.957, 0.953, 0.949],
    [0.971, 0.971, 0.97 , 0.969, 0.967, 0.965],
    [0.505, 0.505, 0.507, 0.503, 0.497, 0.496],
    [0.536, 0.525, 0.523, 0.524, 0.511, 0.514],
    [0.569, 0.563, 0.552, 0.549, 0.55 , 0.541],
    [0.518, 0.513, 0.51 , 0.505, 0.502, 0.497],
    [0.949, 0.948, 0.946, 0.946, 0.944, 0.942],
    [0.517, 0.513, 0.51 , 0.503, 0.495, 0.493],
    [0.984, 0.985, 0.985, 0.983, 0.982, 0.983],
    [0.918, 0.915, 0.912, 0.911, 0.904, 0.901],
    [0.52 , 0.52 , 0.506, 0.51 , 0.502, 0.496],
    [0.964, 0.963, 0.96 , 0.956, 0.953, 0.952],
    [0.98 , 0.98 , 0.978, 0.974, 0.973, 0.97 ],
    [0.535, 0.528, 0.519, 0.521, 0.524, 0.518],
    [0.508, 0.518, 0.514, 0.513, 0.509, 0.502],
    [0.567, 0.566, 0.553, 0.562, 0.55 , 0.546],
    [0.556, 0.545, 0.548, 0.546, 0.533, 0.539],
    [0.646, 0.642, 0.632, 0.636, 0.629, 0.625],
    [0.46 , 0.46 , 0.444, 0.437, 0.426, 0.424],
    [0.625, 0.631, 0.638, 0.628, 0.624, 0.612],
    [0.494, 0.495, 0.489, 0.487, 0.478, 0.476],
    [0.628, 0.622, 0.616, 0.615, 0.616, 0.617],
    [0.402, 0.395, 0.394, 0.389, 0.384, 0.378],
    [0.997, 0.997, 0.997, 0.996, 0.996, 0.996],
    [0.506, 0.507, 0.506, 0.501, 0.49 , 0.494],
    [0.628, 0.631, 0.621, 0.621, 0.622, 0.622],
    [0.641, 0.633, 0.632, 0.631, 0.626, 0.621],
    [0.952, 0.952, 0.953, 0.952, 0.951, 0.948],
    [0.464, 0.459, 0.459, 0.45 , 0.452, 0.444]])
control_run_1_n_images = [
    50, 50, 49, 49, 50, 50, 50, 50, 11, 49,
    50, 24, 50, 50, 50, 49, 50, 50,  7,  9,
    23, 50, 49, 50, 49, 50, 49, 50, 50, 50,
    49, 50, 27, 32, 49, 50, 50, 49, 29, 49,
    50, 49, 49, 49, 50, 50, 50, 49, 43, 21,
    50, 48, 50, 13, 49, 49, 50, 49, 49, 49,
    50, 50, 50, 19]

# ./results/pathfinder/
# BinaryClassifierResnet50_ControlMatchParametersLayer_with_puncturing_run_2_20200913_172901
control_run_2_ch_in = np.array([
    [    0.601,     0.596,     0.594,     0.59 ,     0.583,     0.561],
    [    0.069,     0.068,     0.067,     0.067,     0.067,     0.066],
    [    0.1  ,     0.099,     0.095,     0.094,     0.094,     0.093],
    [    0.642,     0.644,     0.639,     0.637,     0.634,     0.631],
    [    0.577,     0.568,     0.561,     0.554,     0.535,     0.529],
    [    0.009,     0.009,     0.01 ,     0.009,     0.009,     0.009],
    [    1.479,     1.62 ,     1.625,     1.665,     1.722,     1.616],
    [    0.065,     0.056,     0.065,     0.068,     0.054,     0.044],
    [    1.74 ,     1.734,     1.726,     1.755,     1.71 ,     1.699],
    [    0.378,     0.374,     0.381,     0.375,     0.374,     0.368],
    [    1.509,     1.492,     1.498,     1.493,     1.496,     1.49 ],
    [    0.   ,     0.   ,     0.   ,     0.   ,     0.   ,     0.   ],
    [    1.102,     1.105,     1.107,     1.111,     1.107,     1.117],
    [    0.   ,     0.   ,     0.   ,     0.   ,     0.   ,     0.   ],
    [    0.497,     0.496,     0.5  ,     0.498,     0.5  ,     0.494],
    [    3.865,     3.868,     3.855,     3.786,     3.767,     3.756],
    [    0.763,     0.766,     0.758,     0.753,     0.749,     0.717],
    [    1.188,     1.191,     1.151,     1.162,     1.164,     1.241],
    [    0.792,     0.783,     0.836,     0.833,     0.863,     0.934],
    [    0.296,     0.295,     0.291,     0.291,     0.289,     0.286],
    [    1.129,     1.108,     1.074,     1.052,     1.067,     1.092],
    [    0.687,     0.708,     0.743,     0.726,     0.733,     0.738],
    [    0.383,     0.385,     0.453,     0.441,     0.437,     0.518],
    [    0.   ,     0.   ,     0.   ,     0.   ,     0.   ,     0.   ],
    [    0.97 ,     0.975,     0.996,     0.979,     0.974,     1.011],
    [    0.328,     0.327,     0.324,     0.324,     0.316,     0.308],
    [    0.834,     0.85 ,     0.87 ,     0.881,     0.866,     0.873],
    [    3.421,     3.392,     3.329,     3.36 ,     3.24 ,     2.96 ],
    [    1.875,     1.866,     1.853,     1.854,     1.809,     1.809],
    [    0.035,     0.035,     0.035,     0.034,     0.034,     0.033],
    [    0.323,     0.32 ,     0.313,     0.314,     0.31 ,     0.301],
    [    1.443,     1.455,     1.448,     1.436,     1.442,     1.462],
    [    0.179,     0.177,     0.176,     0.176,     0.174,     0.174],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    0.403,     0.402,     0.395,     0.393,     0.391,     0.38 ],
    [    0.258,     0.256,     0.248,     0.249,     0.248,     0.244],
    [    2.428,     2.423,     2.386,     2.381,     2.337,     2.309],
    [    0.178,     0.176,     0.203,     0.208,     0.218,     0.228],
    [    1.452,     1.401,     1.485,     1.467,     1.402,     1.475],
    [    1.07 ,     1.064,     1.105,     1.09 ,     1.084,     1.07 ],
    [    0.259,     0.259,     0.257,     0.258,     0.258,     0.258],
    [    0.506,     0.502,     0.51 ,     0.512,     0.515,     0.522],
    [    0.185,     0.185,     0.185,     0.185,     0.185,     0.186],
    [    0.134,     0.135,     0.132,     0.129,     0.129,     0.128],
    [    0.05 ,     0.05 ,     0.05 ,     0.05 ,     0.049,     0.048],
    [    0.833,     0.821,     0.791,     0.78 ,     0.768,     0.791],
    [    0.   ,     0.   ,     0.   ,     0.   ,     0.   ,     0.   ],
    [    0.01 ,     0.01 ,     0.01 ,     0.01 ,     0.009,     0.009],
    [    0.02 ,     0.021,     0.021,     0.021,     0.021,     0.021],
    [    1.966,     1.983,     1.97 ,     1.967,     1.981,     1.936],
    [    0.136,     0.134,     0.134,     0.134,     0.136,     0.136],
    [    0.   ,     0.   ,     0.   ,     0.   ,     0.   ,     0.   ],
    [    0.033,     0.033,     0.034,     0.033,     0.033,     0.032],
    [    2.585,     2.588,     2.555,     2.546,     2.491,     2.531],
    [    0.705,     0.709,     0.718,     0.708,     0.723,     0.725],
    [    0.631,     0.623,     0.636,     0.665,     0.662,     0.655],
    [    0.414,     0.411,     0.402,     0.401,     0.398,     0.386],
    [    0.006,     0.006,     0.006,     0.006,     0.006,     0.006],
    [    0.043,     0.043,     0.043,     0.043,     0.044,     0.042],
    [    0.008,     0.008,     0.008,     0.008,     0.008,     0.008],
    [    1.312,     1.326,     1.287,     1.283,     1.27 ,     1.272],
    [    0.027,     0.028,     0.027,     0.027,     0.028,     0.027],
    [    0.01 ,     0.01 ,     0.01 ,     0.01 ,     0.01 ,     0.009],
    [    0.106,     0.107,     0.109,     0.106,     0.099,     0.111]])
control_run_2_ch_out = np.array([
    [    0.504,     0.501,     0.499,     0.491,     0.488,     0.485],
    [    1.167,     1.163,     1.15 ,     1.15 ,     1.148,     1.159],
    [    0.155,     0.155,     0.15 ,     0.149,     0.147,     0.147],
    [    0.801,     0.797,     0.793,     0.788,     0.791,     0.806],
    [    0.55 ,     0.56 ,     0.562,     0.569,     0.57 ,     0.568],
    [    0.966,     0.968,     0.965,     0.958,     0.952,     0.94 ],
    [    2.134,     2.129,     2.141,     2.132,     2.136,     2.125],
    [    1.006,     1.01 ,     1.009,     1.009,     1.015,     1.013],
    [    0.597,     0.594,     0.591,     0.589,     0.585,     0.586],
    [    0.379,     0.381,     0.381,     0.382,     0.383,     0.383],
    [    1.106,     1.118,     1.094,     1.076,     1.044,     1.016],
    [    0.653,     0.655,     0.64 ,     0.644,     0.626,     0.612],
    [    1.014,     1.007,     0.994,     0.984,     0.971,     0.96 ],
    [    0.797,     0.8  ,     0.791,     0.786,     0.79 ,     0.789],
    [    0.017,     0.016,     0.013,     0.013,     0.012,     0.006],
    [    0.728,     0.721,     0.71 ,     0.7  ,     0.685,     0.677],
    [    0.515,     0.517,     0.516,     0.518,     0.515,     0.512],
    [    0.88 ,     0.881,     0.868,     0.874,     0.869,     0.869],
    [    0.505,     0.495,     0.486,     0.479,     0.466,     0.456],
    [    0.83 ,     0.836,     0.829,     0.821,     0.826,     0.829],
    [    0.501,     0.51 ,     0.504,     0.504,     0.502,     0.504],
    [    0.735,     0.729,     0.723,     0.718,     0.712,     0.7  ],
    [    0.13 ,     0.129,     0.129,     0.128,     0.127,     0.125],
    [    1.049,     1.051,     1.046,     1.038,     1.033,     1.028],
    [    0.644,     0.641,     0.627,     0.622,     0.61 ,     0.594],
    [    0.432,     0.431,     0.429,     0.423,     0.412,     0.403],
    [    0.647,     0.641,     0.63 ,     0.634,     0.622,     0.617],
    [    0.641,     0.638,     0.637,     0.625,     0.615,     0.598],
    [    0.076,     0.072,     0.07 ,     0.068,     0.063,     0.059],
    [    0.042,     0.039,     0.035,     0.031,     0.027,     0.025],
    [    0.689,     0.691,     0.694,     0.695,     0.697,     0.698],
    [    0.895,     0.906,     0.906,     0.905,     0.901,     0.892],
    [    0.231,     0.236,     0.24 ,     0.241,     0.242,     0.238],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    0.317,     0.316,     0.319,     0.32 ,     0.318,     0.317],
    [    0.85 ,     0.853,     0.851,     0.852,     0.858,     0.84 ],
    [    0.679,     0.678,     0.669,     0.665,     0.658,     0.657],
    [    0.772,     0.774,     0.762,     0.766,     0.757,     0.747],
    [    0.182,     0.183,     0.183,     0.184,     0.185,     0.185],
    [    0.526,     0.525,     0.52 ,     0.52 ,     0.515,     0.515],
    [    0.414,     0.416,     0.415,     0.415,     0.414,     0.415],
    [    0.951,     0.958,     0.971,     0.977,     0.985,     0.983],
    [    0.578,     0.584,     0.585,     0.589,     0.586,     0.584],
    [    1.415,     1.405,     1.393,     1.383,     1.383,     1.369],
    [    0.838,     0.819,     0.795,     0.772,     0.745,     0.723],
    [    0.831,     0.833,     0.841,     0.842,     0.844,     0.85 ],
    [    1.126,     1.139,     1.117,     1.102,     1.097,     1.089],
    [    1.155,     1.154,     1.152,     1.149,     1.142,     1.131],
    [    0.508,     0.516,     0.513,     0.516,     0.521,     0.523],
    [    0.577,     0.579,     0.581,     0.572,     0.564,     0.566],
    [    0.909,     0.902,     0.885,     0.873,     0.855,     0.846],
    [    1.745,     1.748,     1.748,     1.737,     1.73 ,     1.708],
    [    2.645,     2.639,     2.655,     2.663,     2.656,     2.626],
    [    1.354,     1.359,     1.356,     1.354,     1.356,     1.35 ],
    [    1.456,     1.454,     1.438,     1.423,     1.406,     1.382],
    [    1.877,     1.875,     1.869,     1.852,     1.839,     1.818],
    [    0.551,     0.553,     0.549,     0.544,     0.534,     0.527],
    [    0.523,     0.528,     0.528,     0.536,     0.529,     0.528],
    [    1.55 ,     1.529,     1.5  ,     1.475,     1.438,     1.405],
    [    0.899,     0.898,     0.897,     0.906,     0.907,     0.896],
    [    1.187,     1.178,     1.164,     1.17 ,     1.174,     1.164],
    [    0.56 ,     0.557,     0.549,     0.539,     0.525,     0.512],
    [    0.763,     0.76 ,     0.764,     0.764,     0.767,     0.763],
    [    0.706,     0.694,     0.679,     0.675,     0.665,     0.652]])
control_run_2_ch_predicts = np.array([
    [    0.558,     0.561,     0.552,     0.558,     0.553,     0.551],
    [    0.734,     0.735,     0.734,     0.736,     0.734,     0.726],
    [    0.586,     0.586,     0.581,     0.58 ,     0.57 ,     0.576],
    [    0.676,     0.683,     0.675,     0.674,     0.674,     0.675],
    [    0.63 ,     0.633,     0.627,     0.625,     0.625,     0.622],
    [    0.877,     0.888,     0.891,     0.895,     0.901,     0.901],
    [    0.461,     0.462,     0.447,     0.445,     0.44 ,     0.438],
    [    0.476,     0.482,     0.475,     0.485,     0.466,     0.467],
    [    0.678,     0.676,     0.677,     0.67 ,     0.658,     0.654],
    [    0.862,     0.862,     0.859,     0.855,     0.849,     0.846],
    [    0.813,     0.815,     0.814,     0.817,     0.813,     0.821],
    [    0.596,     0.596,     0.595,     0.587,     0.579,     0.57 ],
    [    0.7  ,     0.699,     0.699,     0.693,     0.692,     0.692],
    [    0.681,     0.679,     0.68 ,     0.673,     0.672,     0.667],
    [    0.355,     0.353,     0.347,     0.341,     0.344,     0.339],
    [    0.956,     0.956,     0.956,     0.956,     0.955,     0.956],
    [    0.484,     0.485,     0.483,     0.484,     0.474,     0.476],
    [    0.701,     0.701,     0.699,     0.7  ,     0.696,     0.695],
    [    0.48 ,     0.479,     0.486,     0.484,     0.484,     0.479],
    [    0.537,     0.53 ,     0.523,     0.529,     0.518,     0.509],
    [    0.465,     0.468,     0.468,     0.453,     0.452,     0.451],
    [    0.553,     0.55 ,     0.548,     0.543,     0.54 ,     0.547],
    [    0.401,     0.398,     0.399,     0.395,     0.398,     0.394],
    [    0.529,     0.528,     0.525,     0.515,     0.508,     0.503],
    [    0.659,     0.657,     0.652,     0.645,     0.642,     0.64 ],
    [    0.44 ,     0.44 ,     0.428,     0.428,     0.421,     0.426],
    [    0.466,     0.458,     0.451,     0.446,     0.437,     0.436],
    [    0.484,     0.486,     0.483,     0.491,     0.487,     0.481],
    [    0.464,     0.459,     0.457,     0.447,     0.443,     0.44 ],
    [    0.543,     0.54 ,     0.545,     0.543,     0.541,     0.544],
    [    0.776,     0.767,     0.767,     0.758,     0.752,     0.735],
    [    0.511,     0.502,     0.489,     0.495,     0.484,     0.488],
    [    0.541,     0.533,     0.539,     0.533,     0.535,     0.526],
    [-1000.   , -1000.   , -1000.   , -1000.   , -1000.   , -1000.   ],
    [    0.528,     0.521,     0.512,     0.509,     0.502,     0.492],
    [    0.527,     0.533,     0.524,     0.527,     0.522,     0.526],
    [    0.871,     0.869,     0.861,     0.858,     0.854,     0.85 ],
    [    0.487,     0.486,     0.485,     0.482,     0.479,     0.481],
    [    0.728,     0.724,     0.715,     0.71 ,     0.698,     0.695],
    [    0.429,     0.433,     0.426,     0.428,     0.431,     0.416],
    [    0.854,     0.852,     0.847,     0.849,     0.84 ,     0.839],
    [    0.573,     0.573,     0.573,     0.565,     0.552,     0.56 ],
    [    0.719,     0.72 ,     0.725,     0.719,     0.716,     0.713],
    [    0.469,     0.465,     0.458,     0.454,     0.455,     0.45 ],
    [    0.419,     0.424,     0.42 ,     0.416,     0.419,     0.418],
    [    0.471,     0.471,     0.471,     0.464,     0.458,     0.46 ],
    [    0.842,     0.847,     0.843,     0.844,     0.844,     0.837],
    [    0.474,     0.47 ,     0.461,     0.459,     0.451,     0.449],
    [    0.498,     0.495,     0.494,     0.488,     0.493,     0.475],
    [    0.548,     0.543,     0.54 ,     0.533,     0.537,     0.527],
    [    0.888,     0.889,     0.883,     0.88 ,     0.882,     0.884],
    [    0.915,     0.912,     0.912,     0.911,     0.91 ,     0.905],
    [    0.882,     0.883,     0.89 ,     0.89 ,     0.885,     0.887],
    [    0.927,     0.931,     0.932,     0.933,     0.935,     0.931],
    [    0.661,     0.659,     0.652,     0.647,     0.646,     0.636],
    [    0.837,     0.839,     0.835,     0.827,     0.822,     0.814],
    [    0.903,     0.9  ,     0.895,     0.896,     0.894,     0.884],
    [    0.506,     0.498,     0.495,     0.491,     0.494,     0.492],
    [    0.557,     0.567,     0.565,     0.572,     0.575,     0.579],
    [    0.359,     0.362,     0.356,     0.347,     0.35 ,     0.346],
    [    0.665,     0.67 ,     0.669,     0.665,     0.66 ,     0.665],
    [    0.503,     0.508,     0.517,     0.507,     0.511,     0.507],
    [    0.476,     0.468,     0.465,     0.459,     0.46 ,     0.452],
    [    0.512,     0.516,     0.517,     0.519,     0.522,     0.52 ]])
control_run_2_n_images = [
    42, 50, 50, 50, 49, 50, 49, 49, 50, 49,
    49, 50, 49, 49,  5, 49, 50, 49, 49, 49,
    49, 50, 50, 49, 50, 50, 49, 50, 50, 41,
    50, 50, 50,  0, 50, 40, 50, 49, 49, 50,
    50, 49, 50, 49, 50, 50, 49, 49, 50, 50,
    49, 49, 50, 49, 50, 49, 49, 50, 49, 50,
    50, 50, 49, 50]

# ./results/pathfinder/
# BinaryClassifierResnet50_ControlMatchParametersLayer_with_puncturing_run_3_20200914_231510
control_run_3_ch_in = np.array([
    [3.16 , 3.128, 3.099, 3.075, 3.04 , 3.04 ],
   [0.331, 0.33 , 0.327, 0.326, 0.325, 0.32 ],
   [0.298, 0.296, 0.29 , 0.287, 0.284, 0.281],
   [1.217, 1.211, 1.223, 1.218, 1.278, 1.269],
   [3.743, 3.754, 3.734, 3.713, 3.634, 3.629],
   [0.669, 0.666, 0.659, 0.644, 0.624, 0.621],
   [0.075, 0.076, 0.077, 0.076, 0.078, 0.078],
   [0.91 , 0.895, 0.932, 0.927, 0.913, 1.032],
   [1.193, 1.194, 1.182, 1.2  , 1.183, 1.19 ],
   [0.029, 0.029, 0.028, 0.028, 0.028, 0.028],
   [1.165, 1.172, 1.185, 1.178, 1.183, 1.184],
   [0.016, 0.016, 0.016, 0.016, 0.016, 0.016],
   [0.019, 0.019, 0.024, 0.025, 0.024, 0.025],
   [0.   , 0.   , 0.   , 0.   , 0.   , 0.   ],
   [0.559, 0.554, 0.559, 0.55 , 0.544, 0.534],
   [0.092, 0.093, 0.089, 0.086, 0.088, 0.093],
   [0.05 , 0.049, 0.049, 0.049, 0.048, 0.048],
   [0.854, 0.843, 0.864, 0.856, 0.849, 0.79 ],
   [1.02 , 1.037, 1.047, 1.042, 1.031, 1.038],
   [0.229, 0.23 , 0.23 , 0.23 , 0.23 , 0.226],
   [1.294, 1.323, 1.513, 1.451, 1.392, 1.382],
   [0.318, 0.33 , 0.341, 0.337, 0.338, 0.353],
   [1.524, 1.48 , 1.455, 1.506, 1.517, 1.6  ],
   [0.225, 0.225, 0.225, 0.225, 0.224, 0.223],
   [2.621, 2.609, 2.607, 2.602, 2.6  , 2.576],
   [0.021, 0.022, 0.022, 0.022, 0.022, 0.022],
   [2.707, 2.616, 2.643, 2.699, 2.697, 2.655],
   [1.979, 1.977, 1.97 , 1.973, 1.978, 1.966],
   [0.169, 0.168, 0.172, 0.17 , 0.171, 0.172],
   [0.135, 0.135, 0.133, 0.133, 0.131, 0.127],
   [1.915, 1.914, 1.923, 1.909, 1.919, 1.911],
   [0.024, 0.024, 0.023, 0.023, 0.023, 0.022],
   [0.076, 0.076, 0.073, 0.073, 0.072, 0.07 ],
   [0.508, 0.531, 0.542, 0.504, 0.495, 0.495],
   [0.255, 0.253, 0.252, 0.253, 0.253, 0.252],
   [0.417, 0.415, 0.411, 0.41 , 0.41 , 0.408],
   [0.   , 0.   , 0.   , 0.   , 0.   , 0.   ],
   [0.86 , 0.837, 0.901, 0.902, 0.928, 0.992],
   [1.73 , 1.704, 1.917, 1.789, 1.693, 1.804],
   [0.507, 0.511, 0.516, 0.517, 0.514, 0.512],
   [0.278, 0.278, 0.274, 0.274, 0.272, 0.257],
   [1.017, 1.028, 1.018, 1.04 , 1.041, 1.045],
   [0.012, 0.011, 0.011, 0.011, 0.01 , 0.011],
   [0.011, 0.01 , 0.01 , 0.009, 0.009, 0.008],
   [0.041, 0.041, 0.041, 0.04 , 0.037, 0.037],
   [1.589, 1.596, 1.612, 1.626, 1.628, 1.627],
   [1.863, 1.858, 1.852, 1.863, 1.892, 1.905],
   [2.414, 2.388, 2.388, 2.373, 2.352, 2.307],
   [0.037, 0.036, 0.036, 0.036, 0.035, 0.034],
   [1.291, 1.315, 1.408, 1.357, 1.342, 1.37 ],
   [0.385, 0.376, 0.378, 0.397, 0.399, 0.393],
   [0.804, 0.79 , 0.803, 0.806, 0.804, 0.788],
   [0.007, 0.007, 0.007, 0.007, 0.007, 0.008],
   [1.137, 1.171, 1.191, 1.171, 1.19 , 1.208],
   [1.02 , 1.035, 1.006, 1.004, 0.998, 0.982],
   [0.05 , 0.053, 0.055, 0.056, 0.054, 0.059],
   [0.459, 0.458, 0.457, 0.457, 0.457, 0.452],
   [0.508, 0.509, 0.502, 0.499, 0.499, 0.497],
   [0.526, 0.525, 0.522, 0.52 , 0.514, 0.504],
   [0.032, 0.032, 0.031, 0.031, 0.031, 0.031],
   [0.442, 0.443, 0.468, 0.467, 0.473, 0.455],
   [0.923, 0.922, 0.912, 0.918, 0.915, 0.896],
   [0.009, 0.008, 0.008, 0.008, 0.008, 0.007],
   [1.068, 1.029, 1.037, 1.03 , 1.041, 1.051]])
control_run_3_ch_out = np.array([
    [1.234, 1.223, 1.201, 1.191, 1.164, 1.145],
    [4.481, 4.434, 4.422, 4.42 , 4.397, 4.356],
    [1.632, 1.626, 1.622, 1.613, 1.604, 1.611],
    [1.741, 1.745, 1.736, 1.734, 1.723, 1.712],
    [1.71 , 1.699, 1.709, 1.705, 1.691, 1.68 ],
    [0.547, 0.554, 0.546, 0.542, 0.555, 0.558],
    [1.236, 1.231, 1.227, 1.216, 1.209, 1.199],
    [2.215, 2.215, 2.209, 2.179, 2.141, 2.108],
    [2.572, 2.562, 2.555, 2.564, 2.539, 2.518],
    [3.247, 3.252, 3.259, 3.236, 3.238, 3.217],
    [2.719, 2.736, 2.759, 2.798, 2.796, 2.799],
    [1.954, 1.955, 1.953, 1.936, 1.9  , 1.881],
    [1.861, 1.86 , 1.843, 1.833, 1.819, 1.805],
    [1.397, 1.396, 1.382, 1.375, 1.363, 1.357],
    [4.479, 4.496, 4.505, 4.516, 4.528, 4.559],
    [1.825, 1.824, 1.841, 1.821, 1.812, 1.807],
    [2.922, 2.947, 2.937, 2.941, 2.91 , 2.919],
    [1.765, 1.758, 1.744, 1.721, 1.69 , 1.669],
    [0.464, 0.464, 0.463, 0.463, 0.463, 0.462],
    [0.828, 0.824, 0.82 , 0.817, 0.816, 0.816],
    [1.322, 1.308, 1.293, 1.287, 1.27 , 1.273],
    [2.436, 2.454, 2.436, 2.434, 2.415, 2.395],
    [4.603, 4.593, 4.591, 4.592, 4.569, 4.539],
    [7.051, 7.074, 7.13 , 7.167, 7.217, 7.298],
    [3.805, 3.786, 3.777, 3.744, 3.7  , 3.656],
    [0.575, 0.576, 0.579, 0.582, 0.583, 0.58 ],
    [1.569, 1.556, 1.55 , 1.536, 1.526, 1.527],
    [0.714, 0.71 , 0.704, 0.698, 0.692, 0.686],
    [2.338, 2.369, 2.402, 2.405, 2.428, 2.441],
    [0.82 , 0.821, 0.823, 0.821, 0.821, 0.82 ],
    [8.892, 8.908, 8.939, 8.934, 8.972, 8.975],
    [0.068, 0.067, 0.066, 0.065, 0.063, 0.062],
    [0.772, 0.763, 0.739, 0.728, 0.719, 0.706],
    [0.47 , 0.474, 0.471, 0.462, 0.458, 0.458],
    [0.436, 0.436, 0.435, 0.434, 0.434, 0.429],
    [2.074, 2.093, 2.148, 2.168, 2.178, 2.198],
    [4.038, 4.06 , 4.102, 4.117, 4.152, 4.166],
    [1.255, 1.231, 1.215, 1.223, 1.227, 1.221],
    [4.759, 4.745, 4.729, 4.684, 4.711, 4.681],
    [7.83 , 7.828, 7.82 , 7.823, 7.824, 7.823],
    [1.403, 1.382, 1.365, 1.353, 1.337, 1.318],
    [8.595, 8.604, 8.61 , 8.605, 8.591, 8.596],
    [3.135, 3.087, 3.056, 3.037, 3.   , 2.97 ],
    [3.575, 3.588, 3.584, 3.592, 3.585, 3.601],
    [0.98 , 0.979, 0.981, 0.982, 0.985, 0.985],
    [1.572, 1.564, 1.556, 1.554, 1.548, 1.541],
    [1.209, 1.202, 1.191, 1.175, 1.175, 1.15 ],
    [0.925, 0.906, 0.892, 0.879, 0.861, 0.842],
    [1.129, 1.131, 1.13 , 1.115, 1.093, 1.063],
    [1.331, 1.337, 1.327, 1.33 , 1.316, 1.319],
    [9.602, 9.648, 9.707, 9.71 , 9.743, 9.779],
    [1.441, 1.439, 1.425, 1.428, 1.419, 1.42 ],
    [4.375, 4.428, 4.431, 4.454, 4.472, 4.493],
    [9.453, 9.449, 9.44 , 9.464, 9.486, 9.489],
    [2.588, 2.581, 2.553, 2.568, 2.517, 2.473],
    [3.129, 3.14 , 3.143, 3.149, 3.145, 3.145],
    [3.313, 3.341, 3.333, 3.333, 3.33 , 3.333],
    [2.01 , 2.002, 1.991, 2.   , 2.008, 1.998],
    [2.536, 2.563, 2.576, 2.566, 2.557, 2.569],
    [2.905, 2.882, 2.861, 2.845, 2.806, 2.776],
    [1.755, 1.76 , 1.758, 1.756, 1.749, 1.742],
    [0.305, 0.303, 0.301, 0.296, 0.292, 0.291],
    [3.977, 3.989, 3.982, 3.971, 3.959, 3.937],
    [2.234, 2.245, 2.269, 2.258, 2.27 , 2.282]])
control_run_3_ch_predicts = np.array([
    [0.651, 0.655, 0.646, 0.649, 0.645, 0.648],
    [0.632, 0.632, 0.628, 0.627, 0.623, 0.62 ],
    [0.512, 0.509, 0.513, 0.51 , 0.5  , 0.507],
    [0.466, 0.461, 0.462, 0.461, 0.466, 0.471],
    [0.409, 0.406, 0.399, 0.399, 0.392, 0.386],
    [0.432, 0.426, 0.427, 0.42 , 0.413, 0.41 ],
    [0.634, 0.634, 0.631, 0.634, 0.632, 0.633],
    [0.728, 0.722, 0.722, 0.719, 0.716, 0.708],
    [0.884, 0.882, 0.879, 0.875, 0.872, 0.871],
    [0.834, 0.835, 0.829, 0.828, 0.828, 0.825],
    [0.77 , 0.765, 0.759, 0.762, 0.757, 0.751],
    [0.79 , 0.793, 0.793, 0.79 , 0.783, 0.781],
    [0.843, 0.843, 0.84 , 0.838, 0.838, 0.836],
    [0.897, 0.895, 0.895, 0.895, 0.894, 0.894],
    [0.529, 0.528, 0.524, 0.521, 0.519, 0.516],
    [0.4  , 0.4  , 0.398, 0.396, 0.409, 0.396],
    [0.364, 0.357, 0.356, 0.359, 0.358, 0.359],
    [0.451, 0.451, 0.45 , 0.449, 0.447, 0.444],
    [0.713, 0.71 , 0.712, 0.708, 0.706, 0.702],
    [0.72 , 0.718, 0.714, 0.713, 0.711, 0.707],
    [0.509, 0.503, 0.499, 0.508, 0.501, 0.505],
    [0.538, 0.541, 0.541, 0.541, 0.537, 0.539],
    [0.601, 0.6  , 0.598, 0.595, 0.594, 0.595],
    [0.47 , 0.47 , 0.462, 0.457, 0.449, 0.439],
    [0.93 , 0.928, 0.928, 0.926, 0.924, 0.923],
    [0.435, 0.425, 0.422, 0.42 , 0.421, 0.413],
    [0.354, 0.362, 0.361, 0.364, 0.359, 0.358],
    [0.873, 0.871, 0.87 , 0.87 , 0.869, 0.868],
    [0.449, 0.446, 0.44 , 0.441, 0.436, 0.432],
    [0.782, 0.781, 0.775, 0.771, 0.765, 0.764],
    [0.582, 0.581, 0.577, 0.575, 0.575, 0.572],
    [0.619, 0.622, 0.616, 0.616, 0.613, 0.612],
    [0.544, 0.541, 0.539, 0.54 , 0.538, 0.54 ],
    [0.477, 0.476, 0.466, 0.466, 0.465, 0.474],
    [0.535, 0.535, 0.528, 0.527, 0.514, 0.516],
    [0.758, 0.76 , 0.758, 0.76 , 0.754, 0.758],
    [0.395, 0.394, 0.392, 0.392, 0.383, 0.375],
    [0.469, 0.47 , 0.46 , 0.457, 0.456, 0.456],
    [0.697, 0.697, 0.694, 0.685, 0.68 , 0.673],
    [0.789, 0.789, 0.787, 0.787, 0.786, 0.784],
    [0.389, 0.39 , 0.387, 0.388, 0.383, 0.377],
    [0.629, 0.626, 0.623, 0.618, 0.617, 0.618],
    [0.516, 0.528, 0.525, 0.525, 0.522, 0.521],
    [0.728, 0.729, 0.726, 0.723, 0.717, 0.719],
    [0.602, 0.602, 0.601, 0.61 , 0.607, 0.61 ],
    [0.478, 0.478, 0.477, 0.481, 0.476, 0.475],
    [0.637, 0.638, 0.627, 0.63 , 0.625, 0.628],
    [0.341, 0.338, 0.334, 0.335, 0.331, 0.326],
    [0.294, 0.295, 0.291, 0.286, 0.286, 0.285],
    [0.364, 0.364, 0.359, 0.357, 0.359, 0.351],
    [0.475, 0.473, 0.467, 0.472, 0.467, 0.463],
    [0.358, 0.358, 0.356, 0.356, 0.351, 0.351],
    [0.414, 0.398, 0.401, 0.392, 0.385, 0.385],
    [0.796, 0.801, 0.801, 0.799, 0.8  , 0.798],
    [0.675, 0.674, 0.668, 0.666, 0.667, 0.664],
    [0.876, 0.877, 0.875, 0.874, 0.871, 0.873],
    [0.518, 0.511, 0.51 , 0.513, 0.509, 0.509],
    [0.762, 0.76 , 0.76 , 0.76 , 0.761, 0.759],
    [0.516, 0.511, 0.509, 0.503, 0.506, 0.508],
    [0.872, 0.868, 0.867, 0.867, 0.867, 0.863],
    [0.606, 0.602, 0.601, 0.602, 0.6  , 0.6  ],
    [0.392, 0.384, 0.377, 0.364, 0.358, 0.353],
    [0.406, 0.399, 0.395, 0.396, 0.388, 0.386],
    [0.457, 0.455, 0.451, 0.444, 0.442, 0.441]])
control_run_3_n_images = [
    49, 49, 50, 50, 50, 21, 49, 49, 50, 49,
    49, 49, 50, 50, 50, 49, 49, 49, 50, 50,
    49, 50, 50, 50, 49, 50, 49, 50, 50, 49,
    50, 50, 50, 21, 49, 49, 50, 50, 50, 50,
    50, 49, 50, 49, 49, 50, 49, 50, 50, 50,
    49, 50, 50, 50, 50, 50, 50, 50, 50, 50,
    50, 49, 50, 50]


# ---------------------------------------------------------------------------------------
def get_oo_gains(out_arr, epsilon=1e-4):
    """ gain = output multiple RCD, output rcd=1 (first column) """
    noise_resp_arr = out_arr[:, 0]
    noise_resp_arr = np.expand_dims(noise_resp_arr, axis=1)

    gains = out_arr / (noise_resp_arr + epsilon)
    return gains


def get_gradients_of_linear_fits(x, out_arr):
    out_acts_gradients = []

    for ch_idx in range(len(out_arr)):

        if out_arr[ch_idx, 0] != INVALID_RESULT:
            out_acts = out_arr[ch_idx, ]
            m_out, b_out = np.polyfit(x, out_acts, deg=1)

            out_acts_gradients.append(m_out)

    return np.array(out_acts_gradients)


def plot_combined_figure(
        rcd, m_ch_preds, m_ch_ins, m_ch_outs, m_imgs_ch, c_ch_preds, c_ch_ins, c_ch_outs, c_imgs_ch):
    """

    :param c_ch_ins:
    :param m_ch_ins:
    :param c_imgs_ch:
    :param m_imgs_ch:
    :param rcd:
    :param m_ch_preds:  model sigmodied outputs [ch x n_rcd]
    :param m_ch_outs:   model activations at the output of contour integration layer
    :param c_ch_preds:  control sigmodied outputs
    :param c_ch_outs:

    :return:
    """
    # Results
    # -----------------------------------------------------------------------------------
    # excludes all invalid RESULTS as well
    m_valid_idx_arr = [idx for idx, n_imgs in enumerate(m_imgs_ch) if n_imgs >= MIN_N_IMGS_PER_CHANNEL]
    c_valid_idx_arr = [idx for idx, n_imgs in enumerate(c_imgs_ch) if n_imgs >= MIN_N_IMGS_PER_CHANNEL]

    filtered_m_ch_preds = m_ch_preds[m_valid_idx_arr, ]
    filtered_m_ch_outs = m_ch_outs[m_valid_idx_arr, ]
    filtered_m_ch_ins = m_ch_ins[m_valid_idx_arr, ]
    filtered_m_gains = get_oo_gains(filtered_m_ch_outs)
    m_n_avg = len(filtered_m_ch_outs)

    filtered_c_ch_preds = c_ch_preds[c_valid_idx_arr, ]
    filtered_c_ch_outs = c_ch_outs[c_valid_idx_arr, ]
    filtered_c_ch_ins = c_ch_ins[c_valid_idx_arr, ]
    filtered_c_gains = get_oo_gains(filtered_c_ch_outs)
    c_n_avg = len(filtered_c_ch_outs)

    # Figure
    # -----------------------------------------------------------------------------------
    f = plt.figure(constrained_layout=True, figsize=(12, 9))
    gs = f.add_gridspec(2, 2)

    # Predictions vs Spacing
    # ----------------------
    mean_m_preds = np.mean(filtered_m_ch_preds, axis=0)
    std_m_preds = np.std(filtered_m_ch_preds, axis=0)
    mean_c_preds = np.mean(filtered_c_ch_preds, axis=0)
    std_c_preds = np.std(filtered_c_ch_preds, axis=0)
    print("Mean Model predictions {}".format(mean_m_preds))
    print("Mean Control predictions {}".format(mean_c_preds))

    ax1 = f.add_subplot(gs[0, 0])

    ax1.plot(rcd, mean_m_preds, label='Model', color='b', marker='x')
    ax1.fill_between(rcd, mean_m_preds - std_m_preds, mean_m_preds + std_m_preds, alpha=0.2, color='b')
    ax1.plot(rcd, mean_c_preds, label='Control', color='r', marker='o')
    ax1.fill_between(rcd, mean_c_preds - std_c_preds, mean_c_preds + std_c_preds, alpha=0.2, color='r')

    ax1.set_xlabel("Spacing(RCD)")
    ax1.set_ylabel("Prediction")
    ax1.legend()
    ax1.set_yticks([0, 0.5, 1])
    ax1.text(1, 0.9, 'A', fontsize=30)

    # Gain vs Spacing
    # ----------------
    mean_m_gains = np.mean(filtered_m_gains, axis=0)
    std_m_gains = np.std(filtered_m_gains, axis=0)
    mean_c_gains = np.mean(filtered_c_gains, axis=0)
    std_c_gains = np.std(filtered_c_gains, axis=0)

    ax2 = f.add_subplot(gs[0, 1])

    ax2.plot(rcd, mean_m_gains, label='Model (N={})'.format(m_n_avg), color='b', marker='x')
    ax2.fill_between(rcd, mean_m_gains - std_m_gains, mean_m_gains + std_m_gains, alpha=0.2, color='b')
    ax2.plot(rcd, mean_c_gains, label='Control (N={})'.format(c_n_avg), color='r', marker='o')
    ax2.fill_between(rcd, mean_c_gains - std_c_gains, mean_c_gains + std_c_gains, alpha=0.2, color='r')

    ax2.set_xlabel("Spacing(RCD)")
    ax2.set_ylabel("Gain")
    ax2.text(1, 1.04, 'B', fontsize=30)
    # ax2.legend()

    # histogram Gain Vs Spacing - Model
    # ---------------------------------
    bin_max = 2
    bin_min = -15
    bins = np.arange(bin_min, bin_max, 1)

    m_out_grads = get_gradients_of_linear_fits(rcd, filtered_m_ch_outs)
    m_in_grads = get_gradients_of_linear_fits(rcd, filtered_m_ch_ins)

    ax3 = f.add_subplot(gs[1, 0])
    ax3.hist(
        m_out_grads.clip(min=bin_min, max=bin_max),    # Include all data points
        label="Out".format(m_n_avg), bins=bins, color='blue')

    ax3a = inset_axes(
        ax3,
        width="50%",  # width = 30% of parent_bbox
        height=1.,  # height : 1 inch
        loc='center left',
        bbox_to_anchor=(.15, .3, .6, .6),
        bbox_transform=ax3.transAxes
    )
    # ax3a.set_xlim([-10, 0])
    ax3a.set_title('In')
    ax3a.hist(
        m_in_grads.clip(min=bin_min, max=bin_max),
        label="In ", bins=bins,  color='blue')

    # ax3.legend()
    ax3.set_xlabel("Contour Integration \ngradients activations vs spacing")
    ax3.set_ylabel('Freq')
    ax3.set_xticks(np.arange(-15, 1, 5))
    # ax3.set_title('Out')
    ax3.text(-15, 125, 'C', fontsize=30)

    # histogram Gain Vs Spacing - control
    # -----------------------------------
    c_out_grads = get_gradients_of_linear_fits(rcd, filtered_c_ch_outs)
    c_in_grads = get_gradients_of_linear_fits(rcd, filtered_c_ch_ins)

    ax4 = f.add_subplot(gs[1, 1], sharey=ax3)
    ax4.hist(
        c_out_grads.clip(min=bin_min, max=bin_max),
        label="Control Out \n(N={})".format(c_n_avg), color='r', bins=bins)

    ax4a = inset_axes(
        ax4,
        width="50%",  # width = 30% of parent_bbox
        height=1.,  # height : 1 inch
        loc='center left',
        bbox_to_anchor=(.15, .3, .6, .6),
        bbox_transform=ax4.transAxes
    )
    # ax4a.set_xlim([-10, 0])
    ax4a.set_title('In')
    ax4a.hist(
        c_in_grads.clip(min=bin_min, max=bin_max),
        label="In ", bins=bins, color='red')

    ax4.set_xlabel("Control \ngradients activations vs spacing")
    # ax4.legend()
    ax4.set_ylabel('Freq')
    # ax4.set_title('Out')
    ax4.set_xticks(np.arange(-15, 1, 5))
    ax4.text(-15, 125, 'D', fontsize=30)

    import pdb
    pdb.set_trace()


if __name__ == '__main__':
    plt.ion()

    frag_tile_size = np.array([7, 7])
    bubble_tile_sizes = np.array([[7, 7], [9, 9], [11, 11], [13, 13], [15, 15], [17, 17]])

    # Relative co-linear distance =  spacing / fragment length
    relative_co_linear_dist = bubble_tile_sizes[:, 0] / np.float(frag_tile_size[0])

    combined_model_ch_in = np.concatenate((
        model_run_1_ch_in,
        model_run_2_ch_in,
        model_run_3_ch_in), axis=0)

    combined_model_ch_out = np.concatenate((
        model_run_1_ch_out,
        model_run_2_ch_out,
        model_run_3_ch_out), axis=0)

    combined_model_ch_predicts = np.concatenate((
        model_run_1_ch_predicts,
        model_run_2_ch_predicts,
        model_run_3_ch_predicts), axis=0)

    combined_model_n_images = np.concatenate((
        model_run_1_n_images,
        model_run_2_n_images,
        model_run_3_n_images), axis=0)

    combined_control_ch_in = np.concatenate((
        control_run_1_ch_in,
        control_run_2_ch_in,
        control_run_3_ch_in), axis=0)

    combined_control_ch_out = np.concatenate((
        control_run_1_ch_out,
        control_run_2_ch_out,
        control_run_3_ch_out), axis=0)

    combined_control_ch_predicts = np.concatenate((
        control_run_1_ch_predicts,
        control_run_2_ch_predicts,
        control_run_3_ch_predicts), axis=0)

    combined_control_n_images = np.concatenate((
        control_run_1_n_images,
        control_run_2_n_images,
        control_run_3_n_images), axis=0)

    plot_combined_figure(
        relative_co_linear_dist,
        combined_model_ch_predicts,
        combined_model_ch_in,
        combined_model_ch_out,
        combined_model_n_images,
        combined_control_ch_predicts,
        combined_control_ch_in,
        combined_control_ch_out,
        combined_control_n_images,
    )

    # fig = plt.gcf()
    # fig.suptitle("Combined Results over 3 runs")

    # -----------------------------------------------------------------------------------
    print('End')

    import pdb
    pdb.set_trace()
